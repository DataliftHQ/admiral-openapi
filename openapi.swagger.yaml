swagger: "2.0"
info:
  title: admiral/api/application/v1/application.proto
  version: version not set
tags:
  - name: ApplicationAPI
  - name: ClusterAPI
  - name: EnvironmentAPI
  - name: HealthcheckAPI
  - name: UserAPI
  - name: VariableAPI
consumes:
  - application/json
produces:
  - application/json
paths:
  /healthz:
    get:
      summary: |-
        Healthcheck verifies that the service is running and healthy.
        Returns an empty response on success. Use this endpoint for load balancer
        health checks and monitoring systems.
      operationId: HealthcheckAPI_Healthcheck2
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1HealthcheckResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      tags:
        - HealthcheckAPI
  /v1/applications:
    get:
      summary: |-
        ListApplications returns a paginated list of applications within the
        caller's tenant.
      description: 'Scope: `app:read`'
      operationId: ApplicationAPI_ListApplications
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1ListApplicationsResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: filter
          description: Filter expression using the PEG filter DSL.
          in: query
          required: false
          type: string
        - name: pageSize
          description: Maximum number of applications to return per page.
          in: query
          required: false
          type: integer
          format: int32
        - name: pageToken
          description: Opaque pagination token from a previous response.
          in: query
          required: false
          type: string
      tags:
        - ApplicationAPI
    post:
      summary: CreateApplication creates a new application within the caller's tenant.
      description: 'Scope: `app:write`'
      operationId: ApplicationAPI_CreateApplication
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1CreateApplicationResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: body
          description: CreateApplicationRequest contains the parameters for creating a new application.
          in: body
          required: true
          schema:
            $ref: '#/definitions/v1CreateApplicationRequest'
      tags:
        - ApplicationAPI
  /v1/applications/{application.id}:
    patch:
      summary: |-
        UpdateApplication updates an application's mutable fields.
        Use the `update_mask` to specify which fields to update.
      description: 'Scope: `app:write`'
      operationId: ApplicationAPI_UpdateApplication
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1UpdateApplicationResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: application.id
          description: Unique identifier for the application (UUID).
          in: path
          required: true
          type: string
        - name: body
          in: body
          required: true
          schema:
            $ref: '#/definitions/ApplicationAPIUpdateApplicationBody'
      tags:
        - ApplicationAPI
  /v1/applications/{applicationId}:
    get:
      summary: GetApplication retrieves an application by ID.
      description: 'Scope: `app:read`'
      operationId: ApplicationAPI_GetApplication
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1GetApplicationResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: applicationId
          description: The unique identifier of the application (UUID).
          in: path
          required: true
          type: string
      tags:
        - ApplicationAPI
    delete:
      summary: |-
        DeleteApplication permanently deletes an application and all of its
        associated environments. This action cannot be undone.
      description: 'Scope: `app:write`'
      operationId: ApplicationAPI_DeleteApplication
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1DeleteApplicationResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: applicationId
          description: The unique identifier of the application to delete (UUID).
          in: path
          required: true
          type: string
      tags:
        - ApplicationAPI
  /v1/clusters:
    get:
      summary: ListClusters returns a paginated list of clusters within the caller's tenant.
      description: 'Scope: `cluster:read`'
      operationId: ClusterAPI_ListClusters
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1ListClustersResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: filter
          description: Filter expression using the PEG filter DSL
          in: query
          required: false
          type: string
        - name: pageSize
          description: Maximum number of clusters to return per page.
          in: query
          required: false
          type: integer
          format: int32
        - name: pageToken
          description: Opaque pagination token from a previous response.
          in: query
          required: false
          type: string
      tags:
        - ClusterAPI
    post:
      summary: |-
        CreateCluster creates a new cluster record within the caller's tenant and
        generates an initial Agent Token (AGT) for the K8s agent. The cluster
        starts in PENDING status until an agent registers against it.
      description: |-
        The response includes a `plain_text_token` — the raw AGT secret shown
        exactly once. Deploy this token to the K8s agent (e.g., via Helm values
        or a Kubernetes Secret). The agent uses it to authenticate with
        AgentAPI.RegisterAgent on first boot.

        Scope: `cluster:write`
      operationId: ClusterAPI_CreateCluster
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1CreateClusterResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: body
          description: CreateClusterRequest contains the parameters for creating a new cluster.
          in: body
          required: true
          schema:
            $ref: '#/definitions/v1CreateClusterRequest'
      tags:
        - ClusterAPI
  /v1/clusters/{cluster.id}:
    patch:
      summary: |-
        UpdateCluster updates a cluster's mutable fields.
        Use the `update_mask` to specify which fields to update.
      description: 'Scope: `cluster:write`'
      operationId: ClusterAPI_UpdateCluster
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1UpdateClusterResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: cluster.id
          description: Unique identifier for the cluster (UUID).
          in: path
          required: true
          type: string
        - name: body
          in: body
          required: true
          schema:
            $ref: '#/definitions/ClusterAPIUpdateClusterBody'
      tags:
        - ClusterAPI
  /v1/clusters/{clusterId}:
    get:
      summary: GetCluster retrieves a cluster by ID.
      description: |-
        Returns the Cluster record with its server-derived health_status. For
        detailed telemetry (node counts, resource usage, workload summary), use
        GetClusterStatus instead.

        Scope: `cluster:read`
      operationId: ClusterAPI_GetCluster
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1GetClusterResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: clusterId
          description: The unique identifier of the cluster (UUID).
          in: path
          required: true
          type: string
      tags:
        - ClusterAPI
    delete:
      summary: |-
        DeleteCluster permanently deletes a cluster record and revokes all
        associated agent tokens. This action cannot be undone.
      description: 'Scope: `cluster:write`'
      operationId: ClusterAPI_DeleteCluster
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1DeleteClusterResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: clusterId
          description: |-
            The unique identifier of the cluster to delete (UUID).
            All associated agent tokens will be revoked.
          in: path
          required: true
          type: string
      tags:
        - ClusterAPI
  /v1/clusters/{clusterId}/status:
    get:
      summary: |-
        GetClusterStatus retrieves the current telemetry snapshot for a cluster.
        Returns the latest metrics pushed by the agent, along with server-derived
        health status and workload summary counts.
      description: |-
        Returns NOT_FOUND if the cluster does not exist. If the cluster exists but
        no agent has reported telemetry yet, the response will have health_status
        PENDING and no status message.

        Scope: `cluster:read`
      operationId: ClusterAPI_GetClusterStatus
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1GetClusterStatusResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: clusterId
          description: The unique identifier of the cluster (UUID).
          in: path
          required: true
          type: string
      tags:
        - ClusterAPI
    post:
      summary: |-
        ReportClusterStatus receives a combined telemetry snapshot from a K8s agent.
        The payload includes cluster-level metrics, per-workload status, and
        Kubernetes events. Admiral splits this into three storage tiers on receipt.
      description: |-
        This endpoint is agent-facing and restricted to agent tokens.

        Scope: `cluster:status` | Token types: `agt`
      operationId: ClusterAPI_ReportClusterStatus
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1ReportClusterStatusResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: clusterId
          description: The cluster this status report is for (UUID).
          in: path
          required: true
          type: string
        - name: body
          in: body
          required: true
          schema:
            $ref: '#/definitions/ClusterAPIReportClusterStatusBody'
      tags:
        - ClusterAPI
  /v1/clusters/{clusterId}/tokens:
    get:
      summary: |-
        ListClusterTokens returns a paginated list of AGTs bound to the specified
        cluster. Token secrets are never included.
      description: 'Scope: `cluster:read`'
      operationId: ClusterAPI_ListClusterTokens
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1ListClusterTokensResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: clusterId
          description: The cluster whose tokens to list (UUID).
          in: path
          required: true
          type: string
        - name: pageSize
          description: Maximum number of tokens to return per page.
          in: query
          required: false
          type: integer
          format: int32
        - name: pageToken
          description: Opaque pagination token from a previous response.
          in: query
          required: false
          type: string
        - name: filter
          description: Filter expression using the PEG filter DSL.
          in: query
          required: false
          type: string
      tags:
        - ClusterAPI
    post:
      summary: |-
        CreateClusterToken creates a new Agent Token (AGT) bound to the specified
        cluster. Scopes are auto-assigned and cannot be overridden. The response
        includes the raw token secret, which is shown exactly once.
      description: |-
        Use this to create additional AGTs for an existing cluster (e.g., for
        zero-downtime token rotation). The initial AGT is created automatically
        by CreateCluster.

        Scope: `cluster:write`
      operationId: ClusterAPI_CreateClusterToken
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1CreateClusterTokenResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: clusterId
          description: The cluster to bind this token to (UUID).
          in: path
          required: true
          type: string
        - name: body
          in: body
          required: true
          schema:
            $ref: '#/definitions/ClusterAPICreateClusterTokenBody'
      tags:
        - ClusterAPI
  /v1/clusters/{clusterId}/tokens/{tokenId}:
    get:
      summary: |-
        GetClusterToken retrieves a single AGT by ID.
        Returns metadata only — the token secret is never included.
      description: 'Scope: `cluster:read`'
      operationId: ClusterAPI_GetClusterToken
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1GetClusterTokenResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: clusterId
          description: The cluster the token belongs to (UUID).
          in: path
          required: true
          type: string
        - name: tokenId
          description: The unique identifier of the token (UUID).
          in: path
          required: true
          type: string
      tags:
        - ClusterAPI
  /v1/clusters/{clusterId}/tokens/{tokenId}/revoke:
    post:
      summary: |-
        RevokeClusterToken permanently revokes an AGT bound to this cluster.
        The agent will receive a 401 on its next request. If this is the only
        active AGT for the cluster, the agent will become disconnected.
      description: 'Scope: `cluster:write`'
      operationId: ClusterAPI_RevokeClusterToken
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1RevokeClusterTokenResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: clusterId
          description: The cluster the token belongs to (UUID).
          in: path
          required: true
          type: string
        - name: tokenId
          description: The unique identifier of the token to revoke (UUID).
          in: path
          required: true
          type: string
        - name: body
          in: body
          required: true
          schema:
            $ref: '#/definitions/ClusterAPIRevokeClusterTokenBody'
      tags:
        - ClusterAPI
  /v1/clusters/{clusterId}/workloads:
    get:
      summary: ListWorkloads returns a paginated list of workloads running in a specific cluster.
      description: 'Scope: `cluster:read`'
      operationId: ClusterAPI_ListWorkloads
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1ListWorkloadsResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: clusterId
          description: The cluster whose workloads to list (UUID).
          in: path
          required: true
          type: string
        - name: filter
          description: Filter expression using the PEG filter DSL
          in: query
          required: false
          type: string
        - name: pageSize
          description: Maximum number of workloads to return per page.
          in: query
          required: false
          type: integer
          format: int32
        - name: pageToken
          description: Opaque pagination token from a previous response.
          in: query
          required: false
          type: string
      tags:
        - ClusterAPI
  /v1/clusters/{clusterId}/workloads/status:
    post:
      summary: |-
        ReportWorkloadStatus receives workload-only telemetry from a K8s agent.
        Used for incremental workload updates between full cluster status pushes.
      description: |-
        This endpoint is agent-facing and restricted to agent tokens.

        Scope: `cluster:status` | Token types: `agt`
      operationId: ClusterAPI_ReportWorkloadStatus
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1ReportWorkloadStatusResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: clusterId
          description: The cluster these workloads belong to (UUID).
          in: path
          required: true
          type: string
        - name: body
          in: body
          required: true
          schema:
            $ref: '#/definitions/ClusterAPIReportWorkloadStatusBody'
      tags:
        - ClusterAPI
  /v1/environments:
    get:
      summary: |-
        ListEnvironments returns a paginated list of environments. Use the filter
        to scope by application, runtime type, or labels.
      description: 'Scope: `env:read`'
      operationId: EnvironmentAPI_ListEnvironments
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1ListEnvironmentsResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: filter
          description: Filter expression using the PEG filter DSL.
          in: query
          required: false
          type: string
        - name: pageSize
          description: Maximum number of environments to return per page.
          in: query
          required: false
          type: integer
          format: int32
        - name: pageToken
          description: Opaque pagination token from a previous response.
          in: query
          required: false
          type: string
      tags:
        - EnvironmentAPI
    post:
      summary: CreateEnvironment creates a new environment for the specified application.
      description: 'Scope: `env:write`'
      operationId: EnvironmentAPI_CreateEnvironment
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1CreateEnvironmentResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: body
          description: CreateEnvironmentRequest contains the parameters for creating a new environment.
          in: body
          required: true
          schema:
            $ref: '#/definitions/v1CreateEnvironmentRequest'
      tags:
        - EnvironmentAPI
  /v1/environments/{environment.id}:
    patch:
      summary: |-
        UpdateEnvironment updates an environment's mutable fields.
        Use the `update_mask` to specify which fields to update.
      description: 'Scope: `env:write`'
      operationId: EnvironmentAPI_UpdateEnvironment
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1UpdateEnvironmentResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: environment.id
          description: Unique identifier for the environment (UUID).
          in: path
          required: true
          type: string
        - name: body
          in: body
          required: true
          schema:
            $ref: '#/definitions/EnvironmentAPIUpdateEnvironmentBody'
      tags:
        - EnvironmentAPI
  /v1/environments/{environmentId}:
    get:
      summary: GetEnvironment retrieves an environment by ID.
      description: 'Scope: `env:read`'
      operationId: EnvironmentAPI_GetEnvironment
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1GetEnvironmentResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: environmentId
          description: The unique identifier of the environment (UUID).
          in: path
          required: true
          type: string
      tags:
        - EnvironmentAPI
    delete:
      summary: |-
        DeleteEnvironment permanently deletes an environment. This does not affect
        the underlying runtime — only the Admiral environment record is removed.
        This action cannot be undone.
      description: 'Scope: `env:write`'
      operationId: EnvironmentAPI_DeleteEnvironment
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1DeleteEnvironmentResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: environmentId
          description: The unique identifier of the environment to delete (UUID).
          in: path
          required: true
          type: string
      tags:
        - EnvironmentAPI
  /v1/healthcheck:
    get:
      summary: |-
        Healthcheck verifies that the service is running and healthy.
        Returns an empty response on success. Use this endpoint for load balancer
        health checks and monitoring systems.
      operationId: HealthcheckAPI_Healthcheck
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1HealthcheckResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      tags:
        - HealthcheckAPI
  /v1/user:
    get:
      summary: |-
        GetUser retrieves the profile of the currently authenticated user.
        The user is identified by the authentication token provided in the request.
      operationId: UserAPI_GetUser
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1GetUserResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      tags:
        - UserAPI
  /v1/user/tokens:
    get:
      summary: |-
        ListPersonalAccessTokens returns a paginated list of the authenticated
        user's PATs. Token secrets are never included.
      description: 'Scope: `token:read`'
      operationId: UserAPI_ListPersonalAccessTokens
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1ListPersonalAccessTokensResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: pageSize
          description: Maximum number of tokens to return per page.
          in: query
          required: false
          type: integer
          format: int32
        - name: pageToken
          description: Opaque pagination token from a previous response.
          in: query
          required: false
          type: string
        - name: filter
          description: |-
            Filter expression using the PEG filter DSL
            (e.g., `status = "active"` or `name = "ci-*"`).
          in: query
          required: false
          type: string
      tags:
        - UserAPI
    post:
      summary: |-
        CreatePersonalAccessToken creates a new PAT for the authenticated user.
        The response includes the raw token secret, which is shown exactly once
        and cannot be retrieved again.
      description: 'Scope: `token:write`'
      operationId: UserAPI_CreatePersonalAccessToken
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1CreatePersonalAccessTokenResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: body
          description: CreatePersonalAccessTokenRequest contains the parameters for creating a new PAT.
          in: body
          required: true
          schema:
            $ref: '#/definitions/v1CreatePersonalAccessTokenRequest'
      tags:
        - UserAPI
  /v1/user/tokens/{tokenId}:
    get:
      summary: |-
        GetPersonalAccessToken retrieves a single PAT by ID.
        Returns metadata only — the token secret is never included.
      description: 'Scope: `token:read`'
      operationId: UserAPI_GetPersonalAccessToken
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1GetPersonalAccessTokenResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: tokenId
          description: The unique identifier of the token (UUID).
          in: path
          required: true
          type: string
      tags:
        - UserAPI
  /v1/user/tokens/{tokenId}/revoke:
    post:
      summary: |-
        RevokePersonalAccessToken permanently revokes a PAT. The token becomes
        immediately unusable and cannot be restored.
      description: 'Scope: `token:write`'
      operationId: UserAPI_RevokePersonalAccessToken
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1RevokePersonalAccessTokenResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: tokenId
          description: The unique identifier of the token to revoke (UUID).
          in: path
          required: true
          type: string
        - name: body
          in: body
          required: true
          schema:
            $ref: '#/definitions/UserAPIRevokePersonalAccessTokenBody'
      tags:
        - UserAPI
  /v1/variables:
    get:
      summary: ListVariables returns a merged, paginated list of variables.
      description: |-
        The returned list is a resolved view based on the provided filters:
          - No application_id or environment_id: global variables only.
          - application_id only: global + app-level variables merged.
          - application_id + environment_id: global + app + environment variables merged.

        When variables with the same key exist at multiple levels, all are returned
        so clients can determine precedence.

        Scope: `var:read`
      operationId: VariableAPI_ListVariables
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1ListVariablesResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: applicationId
          description: |-
            Filter to an application (UUID). When set, app-level variables for this
            application are included in the merged result alongside global variables.
          in: query
          required: false
          type: string
        - name: environmentId
          description: |-
            Filter to an environment (UUID). Requires application_id. When set,
            environment-level variables are included alongside global and app variables.
          in: query
          required: false
          type: string
        - name: filter
          description: Filter expression using the PEG filter DSL.
          in: query
          required: false
          type: string
        - name: pageSize
          description: Maximum number of variables to return per page.
          in: query
          required: false
          type: integer
          format: int32
        - name: pageToken
          description: Opaque pagination token from a previous response.
          in: query
          required: false
          type: string
      tags:
        - VariableAPI
    post:
      summary: CreateVariable creates a new variable.
      description: |-
        Fails if a variable with the same key already exists at the same level
        (same key + application_id + environment_id combination).

        Scope: `var:write`
      operationId: VariableAPI_CreateVariable
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1CreateVariableResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: body
          description: |-
            CreateVariableRequest contains the parameters for creating a new variable.
            The variable's scope is derived from the presence of application_id and
            environment_id: neither means global, application_id only means app-scoped,
            both means environment-scoped.
          in: body
          required: true
          schema:
            $ref: '#/definitions/v1CreateVariableRequest'
      tags:
        - VariableAPI
  /v1/variables/{variable.id}:
    patch:
      summary: |-
        UpdateVariable updates a variable's mutable fields.
        Use the `update_mask` to specify which fields to update.
        Only `value` and `sensitive` are mutable — key is immutable.
      description: 'Scope: `var:write`'
      operationId: VariableAPI_UpdateVariable
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1UpdateVariableResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: variable.id
          description: Unique identifier for the variable (UUID).
          in: path
          required: true
          type: string
        - name: body
          in: body
          required: true
          schema:
            $ref: '#/definitions/VariableAPIUpdateVariableBody'
      tags:
        - VariableAPI
  /v1/variables/{variableId}:
    get:
      summary: GetVariable retrieves a variable by ID.
      description: |-
        Sensitive variable values are masked in the response.

        Scope: `var:read`
      operationId: VariableAPI_GetVariable
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1GetVariableResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: variableId
          description: The unique identifier of the variable (UUID).
          in: path
          required: true
          type: string
      tags:
        - VariableAPI
    delete:
      summary: DeleteVariable permanently deletes a variable. This action cannot be undone.
      description: 'Scope: `var:write`'
      operationId: VariableAPI_DeleteVariable
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1DeleteVariableResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: variableId
          description: The unique identifier of the variable to delete (UUID).
          in: path
          required: true
          type: string
      tags:
        - VariableAPI
definitions:
  ApplicationAPIUpdateApplicationBody:
    type: object
    properties:
      application:
        type: object
        properties:
          tenantId:
            type: string
            description: Tenant this application belongs to (UUID).
          name:
            type: string
            description: |-
              URL-safe, human-readable identifier (e.g., "billing-api"). Unique within
              the tenant. Lowercase alphanumeric and hyphens only, must start with a
              letter and end with an alphanumeric character (1-63 chars).
          description:
            type: string
            description: |-
              Optional longer-form description of the application's purpose
              (e.g., "Handles invoice generation and payment processing").
          labels:
            type: object
            additionalProperties:
              type: string
            description: |-
              Arbitrary key-value labels for organizing and filtering applications
              (e.g., `{"team": "payments", "tier": "critical"}`).
          createdAt:
            type: string
            format: date-time
            description: When the application was created.
          updatedAt:
            type: string
            format: date-time
            description: When the application was last updated.
        description: |-
          The application with updated fields. The `id` field is required.
          Only fields specified in `update_mask` are updated.
      updateMask:
        type: string
        description: |-
          The set of fields to update. If unset, all mutable fields are updated.
          Supported fields: `name`, `description`, `labels`.
    description: UpdateApplicationRequest contains the application fields to update.
  ClusterAPICreateClusterTokenBody:
    type: object
    properties:
      name:
        type: string
        description: |-
          URL-safe, human-readable identifier for the token (e.g., "prod-agent-key").
          Must be unique within the cluster's tokens. Lowercase alphanumeric and
          hyphens only.
      expiresAt:
        type: string
        format: date-time
        description: Optional expiration time. If unset, the token does not expire.
    description: |-
      CreateClusterTokenRequest contains the parameters for creating a new AGT
      bound to a cluster.
  ClusterAPIReportClusterStatusBody:
    type: object
    properties:
      status:
        $ref: '#/definitions/v1ClusterStatus'
        description: Cluster-level telemetry snapshot.
      workloads:
        type: array
        items:
          type: object
          $ref: '#/definitions/v1WorkloadStatus'
        description: Per-workload status snapshots.
      events:
        type: array
        items:
          type: object
          $ref: '#/definitions/v1WorkloadEvent'
        description: Kubernetes events observed since the last push.
      reportedAt:
        type: string
        format: date-time
        description: When the agent generated this report.
    description: |-
      ReportClusterStatusRequest contains a combined telemetry payload from a K8s agent.
      Admiral splits this into three storage tiers: current snapshot, time-series
      metrics, and events.
  ClusterAPIReportWorkloadStatusBody:
    type: object
    properties:
      workloads:
        type: array
        items:
          type: object
          $ref: '#/definitions/v1WorkloadStatus'
        description: Per-workload status snapshots.
      reportedAt:
        type: string
        format: date-time
        description: When the agent generated this report.
    description: ReportWorkloadStatusRequest contains incremental workload telemetry from a K8s agent.
  ClusterAPIRevokeClusterTokenBody:
    type: object
    description: RevokeClusterTokenRequest identifies a cluster AGT to revoke.
  ClusterAPIUpdateClusterBody:
    type: object
    properties:
      cluster:
        type: object
        properties:
          tenantId:
            type: string
            description: Tenant this cluster belongs to (UUID).
          name:
            type: string
            description: |-
              URL-safe, human-readable identifier (e.g., "prod-us-east-1"). Unique
              within the tenant. Lowercase alphanumeric and hyphens only, must start
              with a letter and end with an alphanumeric character (1-63 chars).
          description:
            type: string
            description: |-
              Optional longer-form description of the cluster's purpose
              (e.g., "Primary production cluster serving US East traffic").
          labels:
            type: object
            additionalProperties:
              type: string
            description: |-
              Arbitrary key-value labels for organizing and filtering clusters
              (e.g., `{"region": "us-east-1", "cloud": "aws"}`).
          clusterUid:
            type: string
            description: |-
              The Kubernetes kube-system namespace UID, bound at agent registration
              using a first-write-wins strategy. Used to detect when a token is
              accidentally deployed to a different physical cluster.
          healthStatus:
            $ref: '#/definitions/v1ClusterHealthStatus'
            description: Derived health status based on agent connectivity and workload state.
          createdAt:
            type: string
            format: date-time
            description: When the cluster record was created.
          updatedAt:
            type: string
            format: date-time
            description: When the cluster record was last updated.
        description: |-
          The cluster with updated fields. The `id` field is required.
          Only fields specified in `update_mask` are updated.
      updateMask:
        type: string
        description: |-
          The set of fields to update. If unset, all mutable fields are updated.
          Supported fields: `name`, `description`, `labels`.
    description: UpdateClusterRequest contains the cluster fields to update.
  EnvironmentAPIUpdateEnvironmentBody:
    type: object
    properties:
      environment:
        type: object
        properties:
          applicationId:
            type: string
            description: The application this environment belongs to (UUID).
          name:
            type: string
            description: |-
              URL-safe, human-readable identifier (e.g., "prod", "staging-us-east").
              Unique within the application. Lowercase alphanumeric and hyphens only,
              must start with a letter and end with an alphanumeric character (1-63 chars).
          runtimeType:
            $ref: '#/definitions/v1RuntimeType'
            description: |-
              The kind of runtime this environment targets. Optional — can be assigned
              after creation.
          kubernetes:
            $ref: '#/definitions/v1KubernetesConfig'
            description: Kubernetes-specific settings (cluster, namespace).
          labels:
            type: object
            additionalProperties:
              type: string
            description: |-
              Arbitrary key-value labels for organizing and filtering environments
              (e.g., `{"region": "us-east-1", "tier": "production"}`).
          createdAt:
            type: string
            format: date-time
            description: When the environment was created.
          updatedAt:
            type: string
            format: date-time
            description: When the environment was last updated.
        description: |-
          The environment with updated fields. The `id` field is required.
          Only fields specified in `update_mask` are updated.
      updateMask:
        type: string
        description: |-
          The set of fields to update. If unset, all mutable fields are updated.
          Supported fields: `name`, `runtime_type`, `kubernetes`, `labels`.
    description: UpdateEnvironmentRequest contains the environment fields to update.
  UserAPIRevokePersonalAccessTokenBody:
    type: object
    description: RevokePersonalAccessTokenRequest identifies a PAT to revoke.
  VariableAPIUpdateVariableBody:
    type: object
    properties:
      variable:
        type: object
        properties:
          tenantId:
            type: string
            description: Tenant this variable belongs to (UUID).
          key:
            type: string
            description: |-
              The variable name. Must be a valid environment variable identifier
              (e.g., "DATABASE_URL", "API_KEY"). Uppercase alphanumeric and underscores,
              must start with a letter or underscore (max 255 chars).
          value:
            type: string
            description: The variable value. Masked or empty for sensitive variables in responses.
          sensitive:
            type: boolean
            description: Whether the variable value is encrypted at rest and masked in API responses.
          applicationId:
            type: string
            description: |-
              The application this variable is scoped to (UUID). When set, the variable
              is scoped to this application. When both application_id and environment_id
              are set, the variable is scoped to that specific environment.
              Absent means the variable is global (tenant-wide).
          environmentId:
            type: string
            description: |-
              The environment this variable is scoped to (UUID). Requires application_id.
              When set alongside application_id, the variable applies only to this
              specific environment within the application.
          createdBy:
            type: string
            description: User ID who created or last updated the variable.
          createdAt:
            type: string
            format: date-time
            description: When the variable was created.
          updatedAt:
            type: string
            format: date-time
            description: When the variable was last updated.
        description: |-
          The variable with updated fields. The `id` field is required.
          Only fields specified in `update_mask` are updated.
      updateMask:
        type: string
        description: |-
          The set of fields to update. If unset, all mutable fields are updated.
          Supported fields: `value`, `sensitive`.
    description: UpdateVariableRequest contains the variable fields to update.
  protobufAny:
    type: object
    properties:
      '@type':
        type: string
        description: |-
          A URL/resource name that uniquely identifies the type of the serialized
          protocol buffer message. This string must contain at least
          one "/" character. The last segment of the URL's path must represent
          the fully qualified name of the type (as in
          `path/google.protobuf.Duration`). The name should be in a canonical form
          (e.g., leading "." is not accepted).

          In practice, teams usually precompile into the binary all types that they
          expect it to use in the context of Any. However, for URLs which use the
          scheme `http`, `https`, or no scheme, one can optionally set up a type
          server that maps type URLs to message definitions as follows:

          * If no scheme is provided, `https` is assumed.
          * An HTTP GET on the URL must yield a [google.protobuf.Type][]
            value in binary format, or produce an error.
          * Applications are allowed to cache lookup results based on the
            URL, or have them precompiled into a binary to avoid any
            lookup. Therefore, binary compatibility needs to be preserved
            on changes to types. (Use versioned type names to manage
            breaking changes.)

          Note: this functionality is not currently available in the official
          protobuf release, and it is not used for type URLs beginning with
          type.googleapis.com. As of May 2023, there are no widely used type server
          implementations and no plans to implement one.

          Schemes other than `http`, `https` (or the empty scheme) might be
          used with implementation specific semantics.
    additionalProperties: {}
    description: |-
      `Any` contains an arbitrary serialized protocol buffer message along with a
      URL that describes the type of the serialized message.

      Protobuf library provides support to pack/unpack Any values in the form
      of utility functions or additional generated methods of the Any type.

      Example 1: Pack and unpack a message in C++.

          Foo foo = ...;
          Any any;
          any.PackFrom(foo);
          ...
          if (any.UnpackTo(&foo)) {
            ...
          }

      Example 2: Pack and unpack a message in Java.

          Foo foo = ...;
          Any any = Any.pack(foo);
          ...
          if (any.is(Foo.class)) {
            foo = any.unpack(Foo.class);
          }
          // or ...
          if (any.isSameTypeAs(Foo.getDefaultInstance())) {
            foo = any.unpack(Foo.getDefaultInstance());
          }

       Example 3: Pack and unpack a message in Python.

          foo = Foo(...)
          any = Any()
          any.Pack(foo)
          ...
          if any.Is(Foo.DESCRIPTOR):
            any.Unpack(foo)
            ...

       Example 4: Pack and unpack a message in Go

           foo := &pb.Foo{...}
           any, err := anypb.New(foo)
           if err != nil {
             ...
           }
           ...
           foo := &pb.Foo{}
           if err := any.UnmarshalTo(foo); err != nil {
             ...
           }

      The pack methods provided by protobuf library will by default use
      'type.googleapis.com/full.type.name' as the type URL and the unpack
      methods only use the fully qualified type name after the last '/'
      in the type URL, for example "foo.bar.com/x/y.z" will yield type
      name "y.z".

      JSON
      ====
      The JSON representation of an `Any` value uses the regular
      representation of the deserialized, embedded message, with an
      additional field `@type` which contains the type URL. Example:

          package google.profile;
          message Person {
            string first_name = 1;
            string last_name = 2;
          }

          {
            "@type": "type.googleapis.com/google.profile.Person",
            "firstName": <string>,
            "lastName": <string>
          }

      If the embedded message type is well-known and has a custom JSON
      representation, that representation will be embedded adding a field
      `value` which holds the custom JSON in addition to the `@type`
      field. Example (for message [google.protobuf.Duration][]):

          {
            "@type": "type.googleapis.com/google.protobuf.Duration",
            "value": "1.212s"
          }
  rpcStatus:
    type: object
    properties:
      code:
        type: integer
        format: int32
      message:
        type: string
      details:
        type: array
        items:
          type: object
          $ref: '#/definitions/protobufAny'
  v1AccessToken:
    type: object
    properties:
      id:
        type: string
        description: Unique identifier for the token (UUID).
      tenantId:
        type: string
        description: Tenant this token belongs to (UUID).
      name:
        type: string
        description: |-
          URL-safe, human-readable identifier for the token (e.g., "ci-deploy-key").
          Unique within the parent resource. Lowercase alphanumeric and hyphens only,
          must start with a letter and end with an alphanumeric character (1-63 chars).
      tokenType:
        $ref: '#/definitions/v1TokenType'
        description: The category of this token.
      scopes:
        type: array
        items:
          type: string
        description: |-
          The scopes granted to this token. For PATs, these are user-selected.
          For AGTs, these are auto-assigned based on the resource type.
      status:
        $ref: '#/definitions/v1AccessTokenStatus'
        description: Current lifecycle status of the token.
      bindingType:
        $ref: '#/definitions/v1BindingType'
        description: The kind of resource this token is bound to.
      bindingId:
        type: string
        description: The ID of the resource this token is bound to (UUID).
      createdBy:
        type: string
        description: |-
          The user who created this token (UUID). For PATs, this is the token owner.
          For AGTs, this is the administrator who issued the token.
      expiresAt:
        type: string
        format: date-time
        description: When the token expires. If unset, the token does not expire.
      lastUsedAt:
        type: string
        format: date-time
        description: When the token was last used to authenticate an API request.
      createdAt:
        type: string
        format: date-time
        description: When the token was created.
      revokedAt:
        type: string
        format: date-time
        description: When the token was revoked. Only set when status is REVOKED.
    description: |-
      AccessToken contains token metadata common to all token types (PAT, AGT).
      The raw token secret is never included in this message — it is only returned
      once at creation time via the `plain_text_token` field in Create responses.

      Token CRUD is managed by each parent resource's API:
        - PATs:         UserAPI    (/v1/user/tokens)
        - Cluster AGTs: ClusterAPI (/v1/clusters/{id}/tokens)
  v1AccessTokenStatus:
    type: string
    enum:
      - ACCESS_TOKEN_STATUS_UNSPECIFIED
      - ACCESS_TOKEN_STATUS_ACTIVE
      - ACCESS_TOKEN_STATUS_REVOKED
      - ACCESS_TOKEN_STATUS_ROTATING
    default: ACCESS_TOKEN_STATUS_UNSPECIFIED
    description: |-
      AccessTokenStatus represents the lifecycle state of an access token.

       - ACCESS_TOKEN_STATUS_UNSPECIFIED: Default value. Must not be used.
       - ACCESS_TOKEN_STATUS_ACTIVE: The token is valid and can be used for authentication.
       - ACCESS_TOKEN_STATUS_REVOKED: The token has been permanently revoked and cannot be used.
       - ACCESS_TOKEN_STATUS_ROTATING: The token is being rotated. Both old and new tokens are valid
      until the grace period expires.
  v1Application:
    type: object
    properties:
      id:
        type: string
        description: Unique identifier for the application (UUID).
      tenantId:
        type: string
        description: Tenant this application belongs to (UUID).
      name:
        type: string
        description: |-
          URL-safe, human-readable identifier (e.g., "billing-api"). Unique within
          the tenant. Lowercase alphanumeric and hyphens only, must start with a
          letter and end with an alphanumeric character (1-63 chars).
      description:
        type: string
        description: |-
          Optional longer-form description of the application's purpose
          (e.g., "Handles invoice generation and payment processing").
      labels:
        type: object
        additionalProperties:
          type: string
        description: |-
          Arbitrary key-value labels for organizing and filtering applications
          (e.g., `{"team": "payments", "tier": "critical"}`).
      createdAt:
        type: string
        format: date-time
        description: When the application was created.
      updatedAt:
        type: string
        format: date-time
        description: When the application was last updated.
    description: |-
      Application represents a deployable unit within a tenant. An application
      groups manifests, dependencies, and environment configuration into a single
      entity that Admiral orchestrates across environments.
  v1BindingType:
    type: string
    enum:
      - BINDING_TYPE_UNSPECIFIED
      - BINDING_TYPE_USER
      - BINDING_TYPE_CLUSTER
    default: BINDING_TYPE_UNSPECIFIED
    description: |-
      BindingType identifies the kind of resource an access token is bound to.

       - BINDING_TYPE_UNSPECIFIED: Default value. Must not be used.
       - BINDING_TYPE_USER: Token is bound to a user (PATs).
       - BINDING_TYPE_CLUSTER: Token is bound to a cluster (AGTs).
  v1Cluster:
    type: object
    properties:
      id:
        type: string
        description: Unique identifier for the cluster (UUID).
      tenantId:
        type: string
        description: Tenant this cluster belongs to (UUID).
      name:
        type: string
        description: |-
          URL-safe, human-readable identifier (e.g., "prod-us-east-1"). Unique
          within the tenant. Lowercase alphanumeric and hyphens only, must start
          with a letter and end with an alphanumeric character (1-63 chars).
      description:
        type: string
        description: |-
          Optional longer-form description of the cluster's purpose
          (e.g., "Primary production cluster serving US East traffic").
      labels:
        type: object
        additionalProperties:
          type: string
        description: |-
          Arbitrary key-value labels for organizing and filtering clusters
          (e.g., `{"region": "us-east-1", "cloud": "aws"}`).
      clusterUid:
        type: string
        description: |-
          The Kubernetes kube-system namespace UID, bound at agent registration
          using a first-write-wins strategy. Used to detect when a token is
          accidentally deployed to a different physical cluster.
      healthStatus:
        $ref: '#/definitions/v1ClusterHealthStatus'
        description: Derived health status based on agent connectivity and workload state.
      createdAt:
        type: string
        format: date-time
        description: When the cluster record was created.
      updatedAt:
        type: string
        format: date-time
        description: When the cluster record was last updated.
    description: Cluster represents a registered Kubernetes cluster within a tenant.
  v1ClusterHealthStatus:
    type: string
    enum:
      - CLUSTER_HEALTH_STATUS_UNSPECIFIED
      - CLUSTER_HEALTH_STATUS_PENDING
      - CLUSTER_HEALTH_STATUS_HEALTHY
      - CLUSTER_HEALTH_STATUS_DEGRADED
      - CLUSTER_HEALTH_STATUS_ERROR
      - CLUSTER_HEALTH_STATUS_UNREACHABLE
    default: CLUSTER_HEALTH_STATUS_UNSPECIFIED
    description: |-
      ClusterHealthStatus represents the derived health state of a cluster.
      The status is computed from agent connectivity, node readiness, and workload health.

       - CLUSTER_HEALTH_STATUS_UNSPECIFIED: Default value. Must not be used.
       - CLUSTER_HEALTH_STATUS_PENDING: Cluster record exists but no agent has registered yet.
       - CLUSTER_HEALTH_STATUS_HEALTHY: Agent connected, all nodes ready, less than 10% workloads degraded.
       - CLUSTER_HEALTH_STATUS_DEGRADED: Agent connected, some nodes not ready or workloads in error/degraded state.
       - CLUSTER_HEALTH_STATUS_ERROR: Agent connected, more than 25% nodes not ready or workloads in error state.
       - CLUSTER_HEALTH_STATUS_UNREACHABLE: No heartbeat received within 3x the heartbeat interval.
  v1ClusterStatus:
    type: object
    properties:
      k8sVersion:
        type: string
        description: Kubernetes version reported by the agent (e.g., "1.29.2").
      nodeCount:
        type: integer
        format: int32
        description: Total number of nodes in the cluster.
      nodesReady:
        type: integer
        format: int32
        description: Number of nodes in Ready condition.
      podCapacity:
        type: integer
        format: int32
        description: Maximum number of pods the cluster can schedule.
      podCount:
        type: integer
        format: int32
        description: Total number of pods across all namespaces.
      podsRunning:
        type: integer
        format: int32
        description: Number of pods in Running phase.
      podsPending:
        type: integer
        format: int32
        description: Number of pods in Pending phase.
      podsFailed:
        type: integer
        format: int32
        description: Number of pods in Failed phase.
      cpuCapacityMillicores:
        type: string
        format: int64
        description: Total CPU capacity across all nodes, in millicores.
      cpuUsedMillicores:
        type: string
        format: int64
        description: Current CPU usage across all nodes, in millicores.
      memoryCapacityBytes:
        type: string
        format: int64
        description: Total memory capacity across all nodes, in bytes.
      memoryUsedBytes:
        type: string
        format: int64
        description: Current memory usage across all nodes, in bytes.
      workloadsTotal:
        type: integer
        format: int32
        description: Total number of tracked workloads.
      workloadsHealthy:
        type: integer
        format: int32
        description: Number of workloads in healthy state.
      workloadsDegraded:
        type: integer
        format: int32
        description: Number of workloads in degraded state.
      workloadsError:
        type: integer
        format: int32
        description: Number of workloads in error state.
    description: |-
      ClusterStatus contains the raw telemetry metrics for a cluster, as reported
      by the K8s agent. This message is used in both the push payload
      (ReportClusterStatusRequest) and the read response (GetClusterStatusResponse).

      Server-derived fields (health_status, agent connectivity) are NOT included
      here — they live on the Cluster and Agent records respectively, and are
      returned alongside this message in GetClusterStatusResponse.
  v1ContainerStatus:
    type: object
    properties:
      name:
        type: string
        description: Container name within the pod spec.
      image:
        type: string
        description: Container image reference (e.g., "registry.example.com/api:v2.1.4").
      restartCount:
        type: integer
        format: int32
        description: Cumulative number of container restarts.
      state:
        type: string
        description: Current container state (e.g., "running", "waiting", "terminated").
      ready:
        type: boolean
        description: Whether the container's readiness probe is passing.
    description: ContainerStatus describes the current state of a single container.
  v1CreateApplicationRequest:
    type: object
    properties:
      name:
        type: string
        description: |-
          URL-safe, human-readable identifier (e.g., "billing-api"). Must be unique
          within the tenant. Lowercase alphanumeric and hyphens only.
      description:
        type: string
        description: Optional longer-form description of the application's purpose.
      labels:
        type: object
        additionalProperties:
          type: string
        description: Arbitrary key-value labels for organizing and filtering applications.
    description: CreateApplicationRequest contains the parameters for creating a new application.
  v1CreateApplicationResponse:
    type: object
    properties:
      application:
        $ref: '#/definitions/v1Application'
        description: The created application.
    description: CreateApplicationResponse contains the newly created application.
  v1CreateClusterRequest:
    type: object
    properties:
      name:
        type: string
        description: |-
          URL-safe, human-readable identifier (e.g., "prod-us-east-1"). Must be
          unique within the tenant. Lowercase alphanumeric and hyphens only.
      description:
        type: string
        description: Optional longer-form description of the cluster's purpose.
      labels:
        type: object
        additionalProperties:
          type: string
        description: |-
          Arbitrary key-value labels for organizing and filtering clusters
          (e.g., `{"region": "us-east-1", "cloud": "aws"}`).
    description: CreateClusterRequest contains the parameters for creating a new cluster.
  v1CreateClusterResponse:
    type: object
    properties:
      cluster:
        $ref: '#/definitions/v1Cluster'
        description: |-
          The created cluster. Health status will be PENDING until an agent connects
          and calls AgentAPI.RegisterAgent.
      plainTextToken:
        type: string
        description: |-
          The raw Agent Token secret (e.g., "adm_agt_pL2mN5oQ8rS1..."). This value
          is shown exactly once and cannot be retrieved again. Deploy this token to
          the K8s agent for authentication.

          To create additional tokens (e.g., for rotation), use
          AccessTokenAPI.CreateAgentToken.
    description: |-
      CreateClusterResponse contains the newly created cluster and its initial
      Agent Token (AGT).
  v1CreateClusterTokenResponse:
    type: object
    properties:
      accessToken:
        $ref: '#/definitions/v1AccessToken'
        description: The created token metadata. Scopes are auto-assigned for cluster AGTs.
      plainTextToken:
        type: string
        description: |-
          The raw token secret (e.g., "adm_agt_pL2mN5oQ8rS1..."). This value is
          shown exactly once and cannot be retrieved again. Store it securely.
    description: CreateClusterTokenResponse contains the newly created AGT.
  v1CreateEnvironmentRequest:
    type: object
    properties:
      applicationId:
        type: string
        description: The application to create this environment for (UUID).
      name:
        type: string
        description: |-
          URL-safe, human-readable identifier (e.g., "prod", "staging-us-east").
          Must be unique within the application. Lowercase alphanumeric and hyphens only.
      runtimeType:
        $ref: '#/definitions/v1RuntimeType'
        description: |-
          The kind of runtime this environment targets. Optional — can be assigned
          later via UpdateEnvironment.
      kubernetes:
        $ref: '#/definitions/v1KubernetesConfig'
        description: Kubernetes-specific settings (cluster, namespace).
      labels:
        type: object
        additionalProperties:
          type: string
        description: Arbitrary key-value labels for organizing and filtering environments.
    description: CreateEnvironmentRequest contains the parameters for creating a new environment.
  v1CreateEnvironmentResponse:
    type: object
    properties:
      environment:
        $ref: '#/definitions/v1Environment'
        description: The created environment.
    description: CreateEnvironmentResponse contains the newly created environment.
  v1CreatePersonalAccessTokenRequest:
    type: object
    properties:
      name:
        type: string
        description: |-
          URL-safe, human-readable identifier for the token (e.g., "postman-testing").
          Must be unique per user within the tenant. Lowercase alphanumeric and
          hyphens only.
      scopes:
        type: array
        items:
          type: string
        description: The scopes to grant this token. Must be valid scopes allowed for PATs.
      expiresAt:
        type: string
        format: date-time
        description: |-
          Optional expiration time. If unset, the token does not expire.
          Tenant policies may enforce a maximum lifetime.
    description: CreatePersonalAccessTokenRequest contains the parameters for creating a new PAT.
  v1CreatePersonalAccessTokenResponse:
    type: object
    properties:
      accessToken:
        $ref: '#/definitions/v1AccessToken'
        description: The created token metadata.
      plainTextToken:
        type: string
        description: |-
          The raw token secret (e.g., "adm_pat_7kH3mNqR2xFb..."). This value is
          shown exactly once and cannot be retrieved again. Store it securely.
    description: CreatePersonalAccessTokenResponse contains the newly created PAT.
  v1CreateVariableRequest:
    type: object
    properties:
      key:
        type: string
        description: |-
          The variable name. Must be a valid environment variable identifier
          (e.g., "DATABASE_URL", "API_KEY").
      value:
        type: string
        description: The variable value.
      sensitive:
        type: boolean
        description: |-
          Whether the variable value should be encrypted at rest and masked in
          API responses.
      applicationId:
        type: string
        description: |-
          The application to scope this variable to (UUID). When set without
          environment_id, the variable applies to all environments in the app.
      environmentId:
        type: string
        description: |-
          The environment to scope this variable to (UUID). Requires application_id.
          When set, the variable applies only to this specific environment.
    description: |-
      CreateVariableRequest contains the parameters for creating a new variable.
      The variable's scope is derived from the presence of application_id and
      environment_id: neither means global, application_id only means app-scoped,
      both means environment-scoped.
  v1CreateVariableResponse:
    type: object
    properties:
      variable:
        $ref: '#/definitions/v1Variable'
        description: The created variable.
    description: CreateVariableResponse contains the newly created variable.
  v1DeleteApplicationResponse:
    type: object
    description: DeleteApplicationResponse is empty on success.
  v1DeleteClusterResponse:
    type: object
    description: DeleteClusterResponse is empty on success.
  v1DeleteEnvironmentResponse:
    type: object
    description: DeleteEnvironmentResponse is empty on success.
  v1DeleteVariableResponse:
    type: object
    description: DeleteVariableResponse is empty on success.
  v1Environment:
    type: object
    properties:
      id:
        type: string
        description: Unique identifier for the environment (UUID).
      applicationId:
        type: string
        description: The application this environment belongs to (UUID).
      name:
        type: string
        description: |-
          URL-safe, human-readable identifier (e.g., "prod", "staging-us-east").
          Unique within the application. Lowercase alphanumeric and hyphens only,
          must start with a letter and end with an alphanumeric character (1-63 chars).
      runtimeType:
        $ref: '#/definitions/v1RuntimeType'
        description: |-
          The kind of runtime this environment targets. Optional — can be assigned
          after creation.
      kubernetes:
        $ref: '#/definitions/v1KubernetesConfig'
        description: Kubernetes-specific settings (cluster, namespace).
      labels:
        type: object
        additionalProperties:
          type: string
        description: |-
          Arbitrary key-value labels for organizing and filtering environments
          (e.g., `{"region": "us-east-1", "tier": "production"}`).
      createdAt:
        type: string
        format: date-time
        description: When the environment was created.
      updatedAt:
        type: string
        format: date-time
        description: When the environment was last updated.
    description: |-
      Environment represents a named deployment target for an application. Each
      environment binds an application to a runtime where its workloads are deployed.
  v1GetApplicationResponse:
    type: object
    properties:
      application:
        $ref: '#/definitions/v1Application'
        description: The application record.
    description: GetApplicationResponse contains the application record.
  v1GetClusterResponse:
    type: object
    properties:
      cluster:
        $ref: '#/definitions/v1Cluster'
        description: The cluster record, including server-derived health_status.
    description: GetClusterResponse contains the cluster record.
  v1GetClusterStatusResponse:
    type: object
    properties:
      healthStatus:
        $ref: '#/definitions/v1ClusterHealthStatus'
        description: |-
          Server-derived health status based on agent connectivity, node readiness,
          and workload health.
      status:
        $ref: '#/definitions/v1ClusterStatus'
        description: |-
          Latest telemetry snapshot from the agent. Absent if no telemetry has
          been reported yet.
      reportedAt:
        type: string
        format: date-time
        description: When the latest telemetry was reported by the agent.
    description: |-
      GetClusterStatusResponse contains the server-derived health status and the
      latest telemetry snapshot. If no agent has reported telemetry yet, the
      health_status will be PENDING and status will be absent.
  v1GetClusterTokenResponse:
    type: object
    properties:
      accessToken:
        $ref: '#/definitions/v1AccessToken'
        description: The token metadata. The token secret is never included.
    description: GetClusterTokenResponse contains the requested cluster AGT metadata.
  v1GetEnvironmentResponse:
    type: object
    properties:
      environment:
        $ref: '#/definitions/v1Environment'
        description: The environment record.
    description: GetEnvironmentResponse contains the environment record.
  v1GetPersonalAccessTokenResponse:
    type: object
    properties:
      accessToken:
        $ref: '#/definitions/v1AccessToken'
        description: The token metadata. The token secret is never included.
    description: GetPersonalAccessTokenResponse contains the requested PAT metadata.
  v1GetUserResponse:
    type: object
    properties:
      id:
        type: string
        description: Unique identifier for the user (UUID format).
      tenantId:
        type: string
        description: The tenant this user belongs to (UUID format).
      email:
        type: string
        description: User's email address.
      displayName:
        type: string
        description: User's display name for UI purposes.
      givenName:
        type: string
        description: User's given (first) name.
      familyName:
        type: string
        description: User's family (last) name.
      avatarUrl:
        type: string
        description: URL to the user's avatar image.
    description: GetUserResponse contains the authenticated user's profile information.
  v1GetVariableResponse:
    type: object
    properties:
      variable:
        $ref: '#/definitions/v1Variable'
        description: The variable record. Sensitive variable values are masked.
    description: GetVariableResponse contains the variable record.
  v1HealthcheckResponse:
    type: object
    description: |-
      HealthcheckResponse is returned when the service is healthy.
      An empty response indicates the service is operating normally.
  v1KubernetesConfig:
    type: object
    properties:
      clusterId:
        type: string
        description: The cluster this environment deploys to (UUID).
      namespace:
        type: string
        description: |-
          The Kubernetes namespace for this environment's workloads.
          Defaults to the environment name if not specified at deploy time.
    description: KubernetesConfig contains Kubernetes-specific settings for an environment.
  v1ListApplicationsResponse:
    type: object
    properties:
      applications:
        type: array
        items:
          type: object
          $ref: '#/definitions/v1Application'
        description: The list of applications.
      nextPageToken:
        type: string
        description: Pagination token for the next page. Empty when there are no more results.
    description: ListApplicationsResponse contains a page of applications.
  v1ListClusterTokensResponse:
    type: object
    properties:
      accessTokens:
        type: array
        items:
          type: object
          $ref: '#/definitions/v1AccessToken'
        description: The list of tokens. Token secrets are never included.
      nextPageToken:
        type: string
        description: Pagination token for the next page. Empty when there are no more results.
    description: ListClusterTokensResponse contains a page of cluster AGT metadata.
  v1ListClustersResponse:
    type: object
    properties:
      clusters:
        type: array
        items:
          type: object
          $ref: '#/definitions/v1Cluster'
        description: The list of clusters.
      nextPageToken:
        type: string
        description: Pagination token for the next page. Empty when there are no more results.
    description: ListClustersResponse contains a page of clusters.
  v1ListEnvironmentsResponse:
    type: object
    properties:
      environments:
        type: array
        items:
          type: object
          $ref: '#/definitions/v1Environment'
        description: The list of environments.
      nextPageToken:
        type: string
        description: Pagination token for the next page. Empty when there are no more results.
    description: ListEnvironmentsResponse contains a page of environments.
  v1ListPersonalAccessTokensResponse:
    type: object
    properties:
      accessTokens:
        type: array
        items:
          type: object
          $ref: '#/definitions/v1AccessToken'
        description: The list of tokens. Token secrets are never included.
      nextPageToken:
        type: string
        description: Pagination token for the next page. Empty when there are no more results.
    description: ListPersonalAccessTokensResponse contains a page of PAT metadata.
  v1ListVariablesResponse:
    type: object
    properties:
      variables:
        type: array
        items:
          type: object
          $ref: '#/definitions/v1Variable'
        description: The list of variables from all applicable levels.
      nextPageToken:
        type: string
        description: Pagination token for the next page. Empty when there are no more results.
    description: ListVariablesResponse contains a page of variables.
  v1ListWorkloadsResponse:
    type: object
    properties:
      workloads:
        type: array
        items:
          type: object
          $ref: '#/definitions/v1Workload'
        description: The list of workloads.
      nextPageToken:
        type: string
        description: Pagination token for the next page. Empty when there are no more results.
    description: ListWorkloadsResponse contains a page of workloads.
  v1ObjectReference:
    type: object
    properties:
      kind:
        type: string
        description: Kubernetes resource kind (e.g., "Pod", "ReplicaSet").
      namespace:
        type: string
        description: Kubernetes namespace.
      name:
        type: string
        description: Object name.
    description: ObjectReference is a lightweight reference to a Kubernetes object.
  v1ReportClusterStatusResponse:
    type: object
    properties:
      ack:
        type: boolean
        description: Whether the report was accepted.
      nextPushSeconds:
        type: integer
        format: int32
        description: |-
          Server-controlled interval (in seconds) before the agent should send
          its next status push. Allows the server to adjust push frequency dynamically.
    description: ReportClusterStatusResponse acknowledges a telemetry push.
  v1ReportWorkloadStatusResponse:
    type: object
    properties:
      ack:
        type: boolean
        description: Whether the report was accepted.
    description: ReportWorkloadStatusResponse acknowledges a workload telemetry push.
  v1RevokeClusterTokenResponse:
    type: object
    properties:
      accessToken:
        $ref: '#/definitions/v1AccessToken'
        description: The token metadata with updated status.
    description: RevokeClusterTokenResponse contains the revoked cluster AGT metadata.
  v1RevokePersonalAccessTokenResponse:
    type: object
    properties:
      accessToken:
        $ref: '#/definitions/v1AccessToken'
        description: The token metadata with updated status.
    description: RevokePersonalAccessTokenResponse contains the revoked PAT metadata.
  v1RuntimeType:
    type: string
    enum:
      - RUNTIME_TYPE_UNSPECIFIED
      - RUNTIME_TYPE_KUBERNETES
    default: RUNTIME_TYPE_UNSPECIFIED
    description: |-
      RuntimeType identifies the kind of runtime an environment targets.

       - RUNTIME_TYPE_UNSPECIFIED: Default value. Must not be used.
       - RUNTIME_TYPE_KUBERNETES: Kubernetes cluster managed via Admiral's K8s agent.
  v1TokenType:
    type: string
    enum:
      - TOKEN_TYPE_UNSPECIFIED
      - TOKEN_TYPE_PAT
      - TOKEN_TYPE_AGT
    default: TOKEN_TYPE_UNSPECIFIED
    description: |-
      TokenType identifies the category of an access token issued by Admiral's token system.
      IDP-issued JWTs (OAuth2/OIDC sessions) are NOT represented here — they are
      resolved by separate middleware and can be referenced as "session" in
      AuthRule.allowed_token_types when needed.

       - TOKEN_TYPE_UNSPECIFIED: Default value. Must not be used.
       - TOKEN_TYPE_PAT: Personal Access Token, bound to a user.
       - TOKEN_TYPE_AGT: Agent Token, bound to a cluster or runner.
  v1UpdateApplicationResponse:
    type: object
    properties:
      application:
        $ref: '#/definitions/v1Application'
        description: The updated application.
    description: UpdateApplicationResponse contains the updated application.
  v1UpdateClusterResponse:
    type: object
    properties:
      cluster:
        $ref: '#/definitions/v1Cluster'
        description: The updated cluster.
    description: UpdateClusterResponse contains the updated cluster.
  v1UpdateEnvironmentResponse:
    type: object
    properties:
      environment:
        $ref: '#/definitions/v1Environment'
        description: The updated environment.
    description: UpdateEnvironmentResponse contains the updated environment.
  v1UpdateVariableResponse:
    type: object
    properties:
      variable:
        $ref: '#/definitions/v1Variable'
        description: The updated variable.
    description: UpdateVariableResponse contains the updated variable.
  v1Variable:
    type: object
    properties:
      id:
        type: string
        description: Unique identifier for the variable (UUID).
      tenantId:
        type: string
        description: Tenant this variable belongs to (UUID).
      key:
        type: string
        description: |-
          The variable name. Must be a valid environment variable identifier
          (e.g., "DATABASE_URL", "API_KEY"). Uppercase alphanumeric and underscores,
          must start with a letter or underscore (max 255 chars).
      value:
        type: string
        description: The variable value. Masked or empty for sensitive variables in responses.
      sensitive:
        type: boolean
        description: Whether the variable value is encrypted at rest and masked in API responses.
      applicationId:
        type: string
        description: |-
          The application this variable is scoped to (UUID). When set, the variable
          is scoped to this application. When both application_id and environment_id
          are set, the variable is scoped to that specific environment.
          Absent means the variable is global (tenant-wide).
      environmentId:
        type: string
        description: |-
          The environment this variable is scoped to (UUID). Requires application_id.
          When set alongside application_id, the variable applies only to this
          specific environment within the application.
      createdBy:
        type: string
        description: User ID who created or last updated the variable.
      createdAt:
        type: string
        format: date-time
        description: When the variable was created.
      updatedAt:
        type: string
        format: date-time
        description: When the variable was last updated.
    description: |-
      Variable represents a configuration key-value pair scoped to a tenant,
      application, or application+environment. Variables are resolved at deployment
      time into immutable deployment snapshots.
  v1Workload:
    type: object
    properties:
      id:
        type: string
        description: Unique identifier for the workload within Admiral (UUID).
      clusterId:
        type: string
        description: The cluster this workload belongs to (UUID).
      namespace:
        type: string
        description: Kubernetes namespace.
      name:
        type: string
        description: Workload name.
      kind:
        type: string
        description: Kubernetes resource kind (e.g., "Deployment", "StatefulSet", "DaemonSet").
      labels:
        type: object
        additionalProperties:
          type: string
        description: Kubernetes labels on the workload.
      healthStatus:
        $ref: '#/definitions/v1WorkloadHealthStatus'
        description: Derived health status.
      statusReason:
        type: string
        description: Human-readable reason for the current status (e.g., "MinimumReplicasUnavailable").
      replicasDesired:
        type: integer
        format: int32
        description: Number of desired replicas.
      replicasReady:
        type: integer
        format: int32
        description: Number of ready replicas.
      replicasAvailable:
        type: integer
        format: int32
        description: Number of available replicas.
      cpuRequestsMillicores:
        type: string
        format: int64
        description: CPU requests across all containers, in millicores.
      cpuLimitsMillicores:
        type: string
        format: int64
        description: CPU limits across all containers, in millicores.
      cpuUsedMillicores:
        type: string
        format: int64
        description: Current CPU usage across all containers, in millicores.
      memoryRequestsBytes:
        type: string
        format: int64
        description: Memory requests across all containers, in bytes.
      memoryLimitsBytes:
        type: string
        format: int64
        description: Memory limits across all containers, in bytes.
      memoryUsedBytes:
        type: string
        format: int64
        description: Current memory usage across all containers, in bytes.
      containers:
        type: array
        items:
          type: object
          $ref: '#/definitions/v1ContainerStatus'
        description: Status of individual containers in this workload.
      lastUpdatedAt:
        type: string
        format: date-time
        description: When this workload's status was last updated.
    description: |-
      Workload represents a Kubernetes workload (Deployment, StatefulSet,
      DaemonSet, etc.) as observed by the agent.
  v1WorkloadEvent:
    type: object
    properties:
      uid:
        type: string
        description: Kubernetes event UID, used for deduplication.
      type:
        type: string
        description: 'Event type: "Normal" or "Warning".'
      reason:
        type: string
        description: Short machine-readable reason (e.g., "BackOff", "FailedScheduling").
      regarding:
        $ref: '#/definitions/v1ObjectReference'
        description: The Kubernetes object this event is about.
      message:
        type: string
        description: Human-readable event message.
      firstSeen:
        type: string
        format: date-time
        description: When this event was first observed.
      lastSeen:
        type: string
        format: date-time
        description: When this event was most recently observed.
      count:
        type: integer
        format: int32
        description: Number of times this event has occurred.
    description: |-
      WorkloadEvent represents a Kubernetes event related to a workload or its
      child objects (pods, replicasets). Events are deduplicated by their K8s UID.
  v1WorkloadHealthStatus:
    type: string
    enum:
      - WORKLOAD_HEALTH_STATUS_UNSPECIFIED
      - WORKLOAD_HEALTH_STATUS_HEALTHY
      - WORKLOAD_HEALTH_STATUS_DEGRADED
      - WORKLOAD_HEALTH_STATUS_ERROR
    default: WORKLOAD_HEALTH_STATUS_UNSPECIFIED
    description: |-
      WorkloadHealthStatus represents the derived health state of a single workload.

       - WORKLOAD_HEALTH_STATUS_UNSPECIFIED: Default value. Must not be used.
       - WORKLOAD_HEALTH_STATUS_HEALTHY: All desired replicas ready, no CrashLoopBackOff, restarts stable.
       - WORKLOAD_HEALTH_STATUS_DEGRADED: Some replicas not ready, restarts increasing, or pods pending over 5 minutes.
       - WORKLOAD_HEALTH_STATUS_ERROR: Zero ready replicas, all containers CrashLoopBackOff, or deployment stuck.
  v1WorkloadStatus:
    type: object
    properties:
      namespace:
        type: string
        description: Kubernetes namespace.
      name:
        type: string
        description: Workload name.
      kind:
        type: string
        description: Kubernetes resource kind (e.g., "Deployment", "StatefulSet").
      labels:
        type: object
        additionalProperties:
          type: string
        description: Kubernetes labels on the workload.
      replicasDesired:
        type: integer
        format: int32
        description: Number of desired replicas.
      replicasReady:
        type: integer
        format: int32
        description: Number of ready replicas.
      replicasAvailable:
        type: integer
        format: int32
        description: Number of available replicas.
      cpuRequestsMillicores:
        type: string
        format: int64
        description: CPU requests across all containers, in millicores.
      cpuLimitsMillicores:
        type: string
        format: int64
        description: CPU limits across all containers, in millicores.
      cpuUsedMillicores:
        type: string
        format: int64
        description: Current CPU usage across all containers, in millicores.
      memoryRequestsBytes:
        type: string
        format: int64
        description: Memory requests across all containers, in bytes.
      memoryLimitsBytes:
        type: string
        format: int64
        description: Memory limits across all containers, in bytes.
      memoryUsedBytes:
        type: string
        format: int64
        description: Current memory usage across all containers, in bytes.
      healthStatus:
        $ref: '#/definitions/v1WorkloadHealthStatus'
        description: Derived health status.
      containers:
        type: array
        items:
          type: object
          $ref: '#/definitions/v1ContainerStatus'
        description: Status of individual containers.
    description: |-
      WorkloadStatus is the agent-reported status for a single workload within
      a telemetry push payload.
