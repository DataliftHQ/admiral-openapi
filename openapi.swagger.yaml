swagger: "2.0"
info:
  title: authz/v1/annotations.proto
  version: version not set
tags:
  - name: AgentAPI
  - name: ClusterAPI
  - name: HealthcheckAPI
  - name: RunnerAPI
  - name: ServiceAccountAPI
  - name: UserAPI
consumes:
  - application/json
produces:
  - application/json
paths:
  /healthz:
    get:
      summary: |-
        Healthcheck verifies that the service is running and healthy.
        Returns an empty response on success. Use this endpoint for load balancer
        health checks and monitoring systems.
      operationId: HealthcheckAPI_Healthcheck2
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1HealthcheckResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      tags:
        - HealthcheckAPI
  /v1/agents:
    get:
      summary: |-
        ListAgents returns a paginated list of agents within the caller's tenant.
        Use the filter parameter to scope results by resource binding
        (e.g., `cluster_id = "uuid"` or `runner_id = "uuid"`).
      description: 'Scope: `agents:read`'
      operationId: AgentAPI_ListAgents
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1ListAgentsResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: pageSize
          description: Maximum number of agents to return per page.
          in: query
          required: false
          type: integer
          format: int32
        - name: pageToken
          description: Opaque pagination token from a previous response.
          in: query
          required: false
          type: string
        - name: filter
          description: |-
            Filter expression using the PEG filter DSL. Supported fields include
            `cluster_id`, `runner_id`, and `status`.
            Examples: `cluster_id = "uuid"`, `runner_id = "uuid"`, `status = "ONLINE"`.
          in: query
          required: false
          type: string
      tags:
        - AgentAPI
  /v1/agents/{agentId}:
    get:
      summary: |-
        GetAgent retrieves an agent by ID, including its current connectivity
        status and resource binding.
      description: 'Scope: `agents:read`'
      operationId: AgentAPI_GetAgent
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1GetAgentResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: agentId
          description: The unique identifier of the agent (UUID).
          in: path
          required: true
          type: string
      tags:
        - AgentAPI
  /v1/agents/{agentId}/heartbeat:
    post:
      summary: |-
        Heartbeat sends a liveness signal from the agent to the control plane.
        If no heartbeat is received within 3x the poll interval (default 90s),
        the agent transitions to UNREACHABLE status.
      description: 'Scope: `agents:heartbeat` | Token types: `agt`'
      operationId: AgentAPI_Heartbeat
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1HeartbeatResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: agentId
          description: The agent sending the heartbeat (UUID).
          in: path
          required: true
          type: string
        - name: body
          in: body
          required: true
          schema:
            $ref: '#/definitions/AgentAPIHeartbeatBody'
      tags:
        - AgentAPI
  /v1/agents:register:
    post:
      summary: |-
        RegisterAgent registers a new agent, binding it to its parent resource
        (Cluster or Runner). The binding is derived from the AGT used to
        authenticate — the request does not specify which resource to bind to.
      description: |-
        For Kubernetes agents, the request must include `cluster_uid` (the
        kube-system namespace UID). This value is written to the Cluster record
        using a first-write-wins strategy. Subsequent registrations with a
        different UID return 409 Conflict.

        Registration is idempotent: if the agent restarts and calls RegisterAgent
        with the same AGT and matching metadata, the existing agent record is
        returned and its status is set to ONLINE.

        Scope: `agents:write` | Token types: `agt`
      operationId: AgentAPI_RegisterAgent
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1RegisterAgentResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: body
          description: |-
            RegisterAgentRequest contains the parameters for registering a new agent.
            The parent resource binding (Cluster or Runner) is derived from the AGT
            used to authenticate — it does not need to be specified in the request.
          in: body
          required: true
          schema:
            $ref: '#/definitions/v1RegisterAgentRequest'
      tags:
        - AgentAPI
  /v1/clusters:
    get:
      summary: ListClusters returns a paginated list of clusters within the caller's tenant.
      description: 'Scope: `clusters:read`'
      operationId: ClusterAPI_ListClusters
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1ListClustersResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: pageSize
          description: Maximum number of clusters to return per page.
          in: query
          required: false
          type: integer
          format: int32
        - name: pageToken
          description: Opaque pagination token from a previous response.
          in: query
          required: false
          type: string
        - name: filter
          description: |-
            Filter expression using the PEG filter DSL
            (e.g., `health_status = "healthy"` or `labels.region = "us-east-1"`).
          in: query
          required: false
          type: string
      tags:
        - ClusterAPI
    post:
      summary: |-
        CreateCluster creates a new cluster record within the caller's tenant and
        generates an initial Agent Token (AGT) for the K8s agent. The cluster
        starts in PENDING status until an agent registers against it.
      description: |-
        The response includes a `plain_text_token` — the raw AGT secret shown
        exactly once. Deploy this token to the K8s agent (e.g., via Helm values
        or a Kubernetes Secret). The agent uses it to authenticate with
        AgentAPI.RegisterAgent on first boot.

        Scope: `clusters:write`
      operationId: ClusterAPI_CreateCluster
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1CreateClusterResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: body
          description: CreateClusterRequest contains the parameters for creating a new cluster.
          in: body
          required: true
          schema:
            $ref: '#/definitions/v1CreateClusterRequest'
      tags:
        - ClusterAPI
  /v1/clusters/{cluster.id}:
    patch:
      summary: |-
        UpdateCluster updates a cluster's mutable fields (display name, labels).
        Use the `update_mask` to specify which fields to update.
      description: 'Scope: `clusters:write`'
      operationId: ClusterAPI_UpdateCluster
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1UpdateClusterResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: cluster.id
          description: Unique identifier for the cluster (UUID).
          in: path
          required: true
          type: string
        - name: body
          in: body
          required: true
          schema:
            $ref: '#/definitions/ClusterAPIUpdateClusterBody'
      tags:
        - ClusterAPI
  /v1/clusters/{clusterId}:
    get:
      summary: GetCluster retrieves a cluster by ID.
      description: |-
        Returns the Cluster record with its server-derived health_status. For
        detailed telemetry (node counts, resource usage, workload summary), use
        GetClusterStatus instead.

        Scope: `clusters:read`
      operationId: ClusterAPI_GetCluster
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1GetClusterResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: clusterId
          description: The unique identifier of the cluster (UUID).
          in: path
          required: true
          type: string
      tags:
        - ClusterAPI
    delete:
      summary: |-
        DeleteCluster permanently deletes a cluster record and revokes all
        associated agent tokens. This action cannot be undone.
      description: 'Scope: `clusters:write`'
      operationId: ClusterAPI_DeleteCluster
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1DeleteClusterResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: clusterId
          description: |-
            The unique identifier of the cluster to delete (UUID).
            All associated agent tokens will be revoked.
          in: path
          required: true
          type: string
      tags:
        - ClusterAPI
  /v1/clusters/{clusterId}/status:
    get:
      summary: |-
        GetClusterStatus retrieves the current telemetry snapshot for a cluster.
        Returns the latest metrics pushed by the agent, along with server-derived
        health status and workload summary counts.
      description: |-
        Returns NOT_FOUND if the cluster does not exist. If the cluster exists but
        no agent has reported telemetry yet, the response will have health_status
        PENDING and no status message.

        Scope: `clusters:read`
      operationId: ClusterAPI_GetClusterStatus
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1GetClusterStatusResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: clusterId
          description: The unique identifier of the cluster (UUID).
          in: path
          required: true
          type: string
      tags:
        - ClusterAPI
    post:
      summary: |-
        ReportClusterStatus receives a combined telemetry snapshot from a K8s agent.
        The payload includes cluster-level metrics, per-workload status, and
        Kubernetes events. Admiral splits this into three storage tiers on receipt.
      description: |-
        This endpoint is agent-facing and restricted to agent tokens.

        Scope: `clusters:status` | Token types: `agt`
      operationId: ClusterAPI_ReportClusterStatus
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1ReportClusterStatusResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: clusterId
          description: The cluster this status report is for (UUID).
          in: path
          required: true
          type: string
        - name: body
          in: body
          required: true
          schema:
            $ref: '#/definitions/ClusterAPIReportClusterStatusBody'
      tags:
        - ClusterAPI
  /v1/clusters/{clusterId}/tokens:
    get:
      summary: |-
        ListClusterTokens returns a paginated list of AGTs bound to the specified
        cluster. Token secrets are never included.
      description: 'Scope: `clusters:read`'
      operationId: ClusterAPI_ListClusterTokens
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1ListClusterTokensResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: clusterId
          description: The cluster whose tokens to list (UUID).
          in: path
          required: true
          type: string
        - name: pageSize
          description: Maximum number of tokens to return per page.
          in: query
          required: false
          type: integer
          format: int32
        - name: pageToken
          description: Opaque pagination token from a previous response.
          in: query
          required: false
          type: string
        - name: filter
          description: Filter expression using the PEG filter DSL.
          in: query
          required: false
          type: string
      tags:
        - ClusterAPI
    post:
      summary: |-
        CreateClusterToken creates a new Agent Token (AGT) bound to the specified
        cluster. Scopes are auto-assigned and cannot be overridden. The response
        includes the raw token secret, which is shown exactly once.
      description: |-
        Use this to create additional AGTs for an existing cluster (e.g., for
        zero-downtime token rotation). The initial AGT is created automatically
        by CreateCluster.

        Scope: `clusters:write`
      operationId: ClusterAPI_CreateClusterToken
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1CreateClusterTokenResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: clusterId
          description: The cluster to bind this token to (UUID).
          in: path
          required: true
          type: string
        - name: body
          in: body
          required: true
          schema:
            $ref: '#/definitions/ClusterAPICreateClusterTokenBody'
      tags:
        - ClusterAPI
  /v1/clusters/{clusterId}/tokens/{tokenId}:
    get:
      summary: |-
        GetClusterToken retrieves a single AGT by ID.
        Returns metadata only — the token secret is never included.
      description: 'Scope: `clusters:read`'
      operationId: ClusterAPI_GetClusterToken
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1GetClusterTokenResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: clusterId
          description: The cluster the token belongs to (UUID).
          in: path
          required: true
          type: string
        - name: tokenId
          description: The unique identifier of the token (UUID).
          in: path
          required: true
          type: string
      tags:
        - ClusterAPI
  /v1/clusters/{clusterId}/tokens/{tokenId}/revoke:
    post:
      summary: |-
        RevokeClusterToken permanently revokes an AGT bound to this cluster.
        The agent will receive a 401 on its next request. If this is the only
        active AGT for the cluster, the agent will become disconnected.
      description: 'Scope: `clusters:write`'
      operationId: ClusterAPI_RevokeClusterToken
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1RevokeClusterTokenResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: clusterId
          description: The cluster the token belongs to (UUID).
          in: path
          required: true
          type: string
        - name: tokenId
          description: The unique identifier of the token to revoke (UUID).
          in: path
          required: true
          type: string
        - name: body
          in: body
          required: true
          schema:
            $ref: '#/definitions/ClusterAPIRevokeClusterTokenBody'
      tags:
        - ClusterAPI
  /v1/clusters/{clusterId}/workloads:
    get:
      summary: ListWorkloads returns a paginated list of workloads running in a specific cluster.
      description: 'Scope: `clusters:read`'
      operationId: ClusterAPI_ListWorkloads
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1ListWorkloadsResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: clusterId
          description: The cluster whose workloads to list (UUID).
          in: path
          required: true
          type: string
        - name: pageSize
          description: Maximum number of workloads to return per page.
          in: query
          required: false
          type: integer
          format: int32
        - name: pageToken
          description: Opaque pagination token from a previous response.
          in: query
          required: false
          type: string
        - name: filter
          description: |-
            Filter expression using the PEG filter DSL
            (e.g., `namespace = "production"` or `health_status = "degraded"`).
          in: query
          required: false
          type: string
      tags:
        - ClusterAPI
  /v1/clusters/{clusterId}/workloads/status:
    post:
      summary: |-
        ReportWorkloadStatus receives workload-only telemetry from a K8s agent.
        Used for incremental workload updates between full cluster status pushes.
      description: |-
        This endpoint is agent-facing and restricted to agent tokens.

        Scope: `clusters:status` | Token types: `agt`
      operationId: ClusterAPI_ReportWorkloadStatus
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1ReportWorkloadStatusResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: clusterId
          description: The cluster these workloads belong to (UUID).
          in: path
          required: true
          type: string
        - name: body
          in: body
          required: true
          schema:
            $ref: '#/definitions/ClusterAPIReportWorkloadStatusBody'
      tags:
        - ClusterAPI
  /v1/healthcheck:
    get:
      summary: |-
        Healthcheck verifies that the service is running and healthy.
        Returns an empty response on success. Use this endpoint for load balancer
        health checks and monitoring systems.
      operationId: HealthcheckAPI_Healthcheck
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1HealthcheckResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      tags:
        - HealthcheckAPI
  /v1/runners:
    get:
      summary: ListRunners returns a paginated list of runners within the caller's tenant.
      description: 'Scope: `runners:read`'
      operationId: RunnerAPI_ListRunners
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1ListRunnersResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: pageSize
          description: Maximum number of runners to return per page.
          in: query
          required: false
          type: integer
          format: int32
        - name: pageToken
          description: Opaque pagination token from a previous response.
          in: query
          required: false
          type: string
        - name: filter
          description: |-
            Filter expression using the PEG filter DSL.
            Examples: `kind = "TERRAFORM"`, `labels.team = "platform"`.
          in: query
          required: false
          type: string
      tags:
        - RunnerAPI
    post:
      summary: |-
        CreateRunner creates a new runner within the caller's tenant and generates
        an initial Agent Token (AGT) for the controller. The response includes a
        `plain_text_token` — the raw AGT secret shown exactly once.
      description: |-
        Deploy this token to the controller (e.g., via Helm values or a Kubernetes
        Secret). The controller uses it to authenticate with AgentAPI.RegisterAgent
        on first boot.

        Scope: `runners:write`
      operationId: RunnerAPI_CreateRunner
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1CreateRunnerResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: body
          description: CreateRunnerRequest contains the parameters for creating a new runner.
          in: body
          required: true
          schema:
            $ref: '#/definitions/v1CreateRunnerRequest'
      tags:
        - RunnerAPI
  /v1/runners/{runner.id}:
    patch:
      summary: |-
        UpdateRunner updates a runner's mutable fields (display name, labels).
        Use the `update_mask` to specify which fields to update.
      description: 'Scope: `runners:write`'
      operationId: RunnerAPI_UpdateRunner
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1UpdateRunnerResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: runner.id
          description: Unique identifier for the runner (UUID).
          in: path
          required: true
          type: string
        - name: body
          in: body
          required: true
          schema:
            $ref: '#/definitions/RunnerAPIUpdateRunnerBody'
      tags:
        - RunnerAPI
  /v1/runners/{runnerId}:
    get:
      summary: GetRunner retrieves a runner by ID.
      description: 'Scope: `runners:read`'
      operationId: RunnerAPI_GetRunner
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1GetRunnerResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: runnerId
          description: The unique identifier of the runner (UUID).
          in: path
          required: true
          type: string
      tags:
        - RunnerAPI
    delete:
      summary: |-
        DeleteRunner permanently deletes a runner, revokes all associated Agent
        Tokens, and removes the agent record. Running jobs are not interrupted
        but no new jobs will be assigned to this runner.
      description: 'Scope: `runners:write`'
      operationId: RunnerAPI_DeleteRunner
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1DeleteRunnerResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: runnerId
          description: |-
            The unique identifier of the runner to delete (UUID).
            All associated Agent Tokens will be revoked and the agent record removed.
          in: path
          required: true
          type: string
      tags:
        - RunnerAPI
  /v1/runners/{runnerId}/tokens:
    get:
      summary: |-
        ListRunnerTokens returns a paginated list of AGTs bound to the specified
        runner. Token secrets are never included.
      description: 'Scope: `runners:read`'
      operationId: RunnerAPI_ListRunnerTokens
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1ListRunnerTokensResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: runnerId
          description: The runner whose tokens to list (UUID).
          in: path
          required: true
          type: string
        - name: pageSize
          description: Maximum number of tokens to return per page.
          in: query
          required: false
          type: integer
          format: int32
        - name: pageToken
          description: Opaque pagination token from a previous response.
          in: query
          required: false
          type: string
        - name: filter
          description: Filter expression using the PEG filter DSL.
          in: query
          required: false
          type: string
      tags:
        - RunnerAPI
    post:
      summary: |-
        CreateRunnerToken creates a new Agent Token (AGT) bound to the specified
        runner. Scopes are auto-assigned and cannot be overridden. The response
        includes the raw token secret, which is shown exactly once.
      description: |-
        Use this to create additional AGTs for an existing runner (e.g., for
        zero-downtime token rotation). The initial AGT is created automatically
        by CreateRunner.

        Scope: `runners:write`
      operationId: RunnerAPI_CreateRunnerToken
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1CreateRunnerTokenResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: runnerId
          description: The runner to bind this token to (UUID).
          in: path
          required: true
          type: string
        - name: body
          in: body
          required: true
          schema:
            $ref: '#/definitions/RunnerAPICreateRunnerTokenBody'
      tags:
        - RunnerAPI
  /v1/runners/{runnerId}/tokens/{tokenId}:
    get:
      summary: |-
        GetRunnerToken retrieves a single AGT by ID.
        Returns metadata only — the token secret is never included.
      description: 'Scope: `runners:read`'
      operationId: RunnerAPI_GetRunnerToken
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1GetRunnerTokenResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: runnerId
          description: The runner the token belongs to (UUID).
          in: path
          required: true
          type: string
        - name: tokenId
          description: The unique identifier of the token (UUID).
          in: path
          required: true
          type: string
      tags:
        - RunnerAPI
  /v1/runners/{runnerId}/tokens/{tokenId}/revoke:
    post:
      summary: |-
        RevokeRunnerToken permanently revokes an AGT bound to this runner.
        The agent will receive a 401 on its next request. If this is the only
        active AGT for the runner, the agent will become disconnected.
      description: 'Scope: `runners:write`'
      operationId: RunnerAPI_RevokeRunnerToken
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1RevokeRunnerTokenResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: runnerId
          description: The runner the token belongs to (UUID).
          in: path
          required: true
          type: string
        - name: tokenId
          description: The unique identifier of the token to revoke (UUID).
          in: path
          required: true
          type: string
        - name: body
          in: body
          required: true
          schema:
            $ref: '#/definitions/RunnerAPIRevokeRunnerTokenBody'
      tags:
        - RunnerAPI
  /v1/service-accounts:
    get:
      summary: |-
        ListServiceAccounts returns a paginated list of service accounts
        within the caller's tenant.
      description: 'Scope: `sa:read`'
      operationId: ServiceAccountAPI_ListServiceAccounts
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1ListServiceAccountsResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: pageSize
          description: Maximum number of service accounts to return per page.
          in: query
          required: false
          type: integer
          format: int32
        - name: pageToken
          description: Opaque pagination token from a previous response.
          in: query
          required: false
          type: string
        - name: filter
          description: |-
            Filter expression using the PEG filter DSL
            (e.g., `status = "active"` or `display_name = "ci-*"`).
          in: query
          required: false
          type: string
      tags:
        - ServiceAccountAPI
    post:
      summary: CreateServiceAccount creates a new service account within the caller's tenant.
      description: 'Scope: `sa:write`'
      operationId: ServiceAccountAPI_CreateServiceAccount
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1CreateServiceAccountResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: body
          description: CreateServiceAccountRequest contains the parameters for creating a new service account.
          in: body
          required: true
          schema:
            $ref: '#/definitions/v1CreateServiceAccountRequest'
      tags:
        - ServiceAccountAPI
  /v1/service-accounts/{serviceAccount.id}:
    patch:
      summary: |-
        UpdateServiceAccount updates a service account's mutable fields.
        Use the `update_mask` to specify which fields to update.
        Setting status to DISABLED invalidates all associated SATs.
      description: 'Scope: `sa:write`'
      operationId: ServiceAccountAPI_UpdateServiceAccount
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1UpdateServiceAccountResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: serviceAccount.id
          description: Unique identifier for the service account (UUID).
          in: path
          required: true
          type: string
        - name: body
          in: body
          required: true
          schema:
            $ref: '#/definitions/ServiceAccountAPIUpdateServiceAccountBody'
      tags:
        - ServiceAccountAPI
  /v1/service-accounts/{serviceAccountId}:
    get:
      summary: GetServiceAccount retrieves a service account by ID.
      description: 'Scope: `sa:read`'
      operationId: ServiceAccountAPI_GetServiceAccount
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1GetServiceAccountResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: serviceAccountId
          description: The unique identifier of the service account (UUID).
          in: path
          required: true
          type: string
      tags:
        - ServiceAccountAPI
    delete:
      summary: |-
        DeleteServiceAccount permanently deletes a service account and revokes
        all associated SATs. This action cannot be undone.
      description: 'Scope: `sa:write`'
      operationId: ServiceAccountAPI_DeleteServiceAccount
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1DeleteServiceAccountResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: serviceAccountId
          description: |-
            The unique identifier of the service account to delete (UUID).
            All associated SATs will be revoked.
          in: path
          required: true
          type: string
      tags:
        - ServiceAccountAPI
  /v1/service-accounts/{serviceAccountId}/tokens:
    get:
      summary: |-
        ListServiceAccountTokens returns a paginated list of tokens for a
        service account. Token secrets are never included.
      description: 'Scope: `sa:read`'
      operationId: ServiceAccountAPI_ListServiceAccountTokens
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1ListServiceAccountTokensResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: serviceAccountId
          description: The service account whose tokens to list (UUID).
          in: path
          required: true
          type: string
        - name: pageSize
          description: Maximum number of tokens to return per page.
          in: query
          required: false
          type: integer
          format: int32
        - name: pageToken
          description: Opaque pagination token from a previous response.
          in: query
          required: false
          type: string
        - name: filter
          description: Filter expression using the PEG filter DSL.
          in: query
          required: false
          type: string
      tags:
        - ServiceAccountAPI
    post:
      summary: |-
        CreateServiceAccountToken creates a new SAT under the specified service
        account. The token's scopes must be a subset of the parent service
        account's allowed scopes. The response includes the raw token secret,
        which is shown exactly once.
      description: 'Scope: `sa:write`'
      operationId: ServiceAccountAPI_CreateServiceAccountToken
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1CreateServiceAccountTokenResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: serviceAccountId
          description: The service account to create the token under (UUID).
          in: path
          required: true
          type: string
        - name: body
          in: body
          required: true
          schema:
            $ref: '#/definitions/ServiceAccountAPICreateServiceAccountTokenBody'
      tags:
        - ServiceAccountAPI
  /v1/service-accounts/{serviceAccountId}/tokens/{tokenId}:
    get:
      summary: |-
        GetServiceAccountToken retrieves a single SAT by ID.
        Returns metadata only — the token secret is never included.
      description: 'Scope: `sa:read`'
      operationId: ServiceAccountAPI_GetServiceAccountToken
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1GetServiceAccountTokenResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: serviceAccountId
          description: The service account the token belongs to (UUID).
          in: path
          required: true
          type: string
        - name: tokenId
          description: The unique identifier of the token (UUID).
          in: path
          required: true
          type: string
      tags:
        - ServiceAccountAPI
  /v1/service-accounts/{serviceAccountId}/tokens/{tokenId}/revoke:
    post:
      summary: |-
        RevokeServiceAccountToken permanently revokes a SAT. The token becomes
        immediately unusable and cannot be restored.
      description: 'Scope: `sa:write`'
      operationId: ServiceAccountAPI_RevokeServiceAccountToken
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1RevokeServiceAccountTokenResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: serviceAccountId
          description: The service account the token belongs to (UUID).
          in: path
          required: true
          type: string
        - name: tokenId
          description: The unique identifier of the token to revoke (UUID).
          in: path
          required: true
          type: string
        - name: body
          in: body
          required: true
          schema:
            $ref: '#/definitions/ServiceAccountAPIRevokeServiceAccountTokenBody'
      tags:
        - ServiceAccountAPI
  /v1/user:
    get:
      summary: |-
        GetUser retrieves the profile of the currently authenticated user.
        The user is identified by the authentication token provided in the request.
      operationId: UserAPI_GetUser
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1GetUserResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      tags:
        - UserAPI
  /v1/user/tokens:
    get:
      summary: |-
        ListPersonalAccessTokens returns a paginated list of the authenticated
        user's PATs. Token secrets are never included.
      description: 'Scope: `tokens:read`'
      operationId: UserAPI_ListPersonalAccessTokens
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1ListPersonalAccessTokensResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: pageSize
          description: Maximum number of tokens to return per page.
          in: query
          required: false
          type: integer
          format: int32
        - name: pageToken
          description: Opaque pagination token from a previous response.
          in: query
          required: false
          type: string
        - name: filter
          description: |-
            Filter expression using the PEG filter DSL
            (e.g., `status = "active"` or `display_name = "ci-*"`).
          in: query
          required: false
          type: string
      tags:
        - UserAPI
    post:
      summary: |-
        CreatePersonalAccessToken creates a new PAT for the authenticated user.
        The response includes the raw token secret, which is shown exactly once
        and cannot be retrieved again.
      description: 'Scope: `tokens:write`'
      operationId: UserAPI_CreatePersonalAccessToken
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1CreatePersonalAccessTokenResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: body
          description: CreatePersonalAccessTokenRequest contains the parameters for creating a new PAT.
          in: body
          required: true
          schema:
            $ref: '#/definitions/v1CreatePersonalAccessTokenRequest'
      tags:
        - UserAPI
  /v1/user/tokens/{tokenId}:
    get:
      summary: |-
        GetPersonalAccessToken retrieves a single PAT by ID.
        Returns metadata only — the token secret is never included.
      description: 'Scope: `tokens:read`'
      operationId: UserAPI_GetPersonalAccessToken
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1GetPersonalAccessTokenResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: tokenId
          description: The unique identifier of the token (UUID).
          in: path
          required: true
          type: string
      tags:
        - UserAPI
  /v1/user/tokens/{tokenId}/revoke:
    post:
      summary: |-
        RevokePersonalAccessToken permanently revokes a PAT. The token becomes
        immediately unusable and cannot be restored.
      description: 'Scope: `tokens:write`'
      operationId: UserAPI_RevokePersonalAccessToken
      responses:
        "200":
          description: A successful response.
          schema:
            $ref: '#/definitions/v1RevokePersonalAccessTokenResponse'
        default:
          description: An unexpected error response.
          schema:
            $ref: '#/definitions/rpcStatus'
      parameters:
        - name: tokenId
          description: The unique identifier of the token to revoke (UUID).
          in: path
          required: true
          type: string
        - name: body
          in: body
          required: true
          schema:
            $ref: '#/definitions/UserAPIRevokePersonalAccessTokenBody'
      tags:
        - UserAPI
definitions:
  AgentAPIHeartbeatBody:
    type: object
    properties:
      version:
        type: string
        description: Current agent software version.
      uptimeSeconds:
        type: string
        format: int64
        description: How long the agent process has been running, in seconds.
    description: HeartbeatRequest contains a liveness signal from the agent.
  ClusterAPICreateClusterTokenBody:
    type: object
    properties:
      displayName:
        type: string
        description: Human-readable name for the token (e.g., "prod-us-east-1-agent-key").
      expiresAt:
        type: string
        format: date-time
        description: Optional expiration time. If unset, the token does not expire.
    description: |-
      CreateClusterTokenRequest contains the parameters for creating a new AGT
      bound to a cluster.
  ClusterAPIReportClusterStatusBody:
    type: object
    properties:
      status:
        $ref: '#/definitions/v1ClusterStatus'
        description: Cluster-level telemetry snapshot.
      workloads:
        type: array
        items:
          type: object
          $ref: '#/definitions/v1WorkloadStatus'
        description: Per-workload status snapshots.
      events:
        type: array
        items:
          type: object
          $ref: '#/definitions/v1WorkloadEvent'
        description: Kubernetes events observed since the last push.
      reportedAt:
        type: string
        format: date-time
        description: When the agent generated this report.
    description: |-
      ReportClusterStatusRequest contains a combined telemetry payload from a K8s agent.
      Admiral splits this into three storage tiers: current snapshot, time-series
      metrics, and events.
  ClusterAPIReportWorkloadStatusBody:
    type: object
    properties:
      workloads:
        type: array
        items:
          type: object
          $ref: '#/definitions/v1WorkloadStatus'
        description: Per-workload status snapshots.
      reportedAt:
        type: string
        format: date-time
        description: When the agent generated this report.
    description: ReportWorkloadStatusRequest contains incremental workload telemetry from a K8s agent.
  ClusterAPIRevokeClusterTokenBody:
    type: object
    description: RevokeClusterTokenRequest identifies a cluster AGT to revoke.
  ClusterAPIUpdateClusterBody:
    type: object
    properties:
      cluster:
        type: object
        properties:
          tenantId:
            type: string
            description: Tenant this cluster belongs to (UUID).
          displayName:
            type: string
            description: Human-readable name (e.g., "prod-us-east-1"). Unique within the tenant.
          labels:
            type: object
            additionalProperties:
              type: string
            description: |-
              Arbitrary key-value labels for organizing and filtering clusters
              (e.g., `{"region": "us-east-1", "cloud": "aws"}`).
          clusterUid:
            type: string
            description: |-
              The Kubernetes kube-system namespace UID, bound at agent registration
              using a first-write-wins strategy. Used to detect when a token is
              accidentally deployed to a different physical cluster.
          healthStatus:
            $ref: '#/definitions/v1ClusterHealthStatus'
            description: Derived health status based on agent connectivity and workload state.
          createdAt:
            type: string
            format: date-time
            description: When the cluster record was created.
          updatedAt:
            type: string
            format: date-time
            description: When the cluster record was last updated.
        description: |-
          The cluster with updated fields. The `id` field is required.
          Only fields specified in `update_mask` are updated.
      updateMask:
        type: string
        description: |-
          The set of fields to update. If unset, all mutable fields are updated.
          Supported fields: `display_name`, `labels`.
    description: UpdateClusterRequest contains the cluster fields to update.
  RunnerAPICreateRunnerTokenBody:
    type: object
    properties:
      displayName:
        type: string
        description: Human-readable name for the token (e.g., "team1-terraform-agent-key").
      expiresAt:
        type: string
        format: date-time
        description: Optional expiration time. If unset, the token does not expire.
    description: |-
      CreateRunnerTokenRequest contains the parameters for creating a new AGT
      bound to a runner.
  RunnerAPIRevokeRunnerTokenBody:
    type: object
    description: RevokeRunnerTokenRequest identifies a runner AGT to revoke.
  RunnerAPIUpdateRunnerBody:
    type: object
    properties:
      runner:
        type: object
        properties:
          tenantId:
            type: string
            description: Tenant this runner belongs to (UUID).
          displayName:
            type: string
            description: Human-readable name (e.g., "team1-terraform"). Unique within the tenant.
          kind:
            $ref: '#/definitions/v1RunnerKind'
            description: The type of jobs this runner can execute.
          labels:
            type: object
            additionalProperties:
              type: string
            description: |-
              Arbitrary key-value labels for organizing, filtering, and job routing.
              Labels are set by admins and used in the UI to select which runner should
              execute a given module or workflow (e.g., `{"team": "platform", "env": "prod"}`).
          createdAt:
            type: string
            format: date-time
            description: When the runner was created.
          updatedAt:
            type: string
            format: date-time
            description: When the runner was last updated.
        description: |-
          The runner with updated fields. The `id` field is required.
          Only fields specified in `update_mask` are updated.
      updateMask:
        type: string
        description: |-
          The set of fields to update. If unset, all mutable fields are updated.
          Supported fields: `display_name`, `labels`.
    description: UpdateRunnerRequest contains the runner fields to update.
  ServiceAccountAPICreateServiceAccountTokenBody:
    type: object
    properties:
      displayName:
        type: string
        description: |-
          Human-readable name for the token (e.g., "github-actions-key").
          Must be unique per service account.
      scopes:
        type: array
        items:
          type: string
        description: |-
          The scopes to grant this token. Must be a subset of the parent service
          account's allowed scopes.
      expiresAt:
        type: string
        format: date-time
        description: Optional expiration time. If unset, the token does not expire.
    description: CreateServiceAccountTokenRequest contains the parameters for creating a new SAT.
  ServiceAccountAPIRevokeServiceAccountTokenBody:
    type: object
    description: RevokeServiceAccountTokenRequest identifies a SAT to revoke.
  ServiceAccountAPIUpdateServiceAccountBody:
    type: object
    properties:
      serviceAccount:
        type: object
        properties:
          tenantId:
            type: string
            description: Tenant this service account belongs to (UUID).
          displayName:
            type: string
            description: Human-readable name, unique within the tenant (e.g., "ci-pipeline").
          description:
            type: string
            description: |-
              Optional description of the service account's purpose
              (e.g., "GitHub Actions deployment automation").
          scopes:
            type: array
            items:
              type: string
            description: |-
              The set of scopes this service account is allowed to use.
              SATs created under this account can only request a subset of these scopes.
          status:
            $ref: '#/definitions/v1ServiceAccountStatus'
            description: Current lifecycle status.
          createdBy:
            type: string
            description: |-
              The user who created this service account (UUID). For audit purposes only —
              the service account is not bound to this user's access.
          createdAt:
            type: string
            format: date-time
            description: When the service account was created.
          updatedAt:
            type: string
            format: date-time
            description: When the service account was last updated.
        description: |-
          The service account with updated fields. The `id` field is required
          to identify the resource. Only fields specified in `update_mask` are updated.
      updateMask:
        type: string
        description: |-
          The set of fields to update. If unset, all mutable fields are updated.
          Supported fields: `display_name`, `description`, `scopes`, `status`.
    description: UpdateServiceAccountRequest contains the service account fields to update.
  UserAPIRevokePersonalAccessTokenBody:
    type: object
    description: RevokePersonalAccessTokenRequest identifies a PAT to revoke.
  protobufAny:
    type: object
    properties:
      '@type':
        type: string
        description: |-
          A URL/resource name that uniquely identifies the type of the serialized
          protocol buffer message. This string must contain at least
          one "/" character. The last segment of the URL's path must represent
          the fully qualified name of the type (as in
          `path/google.protobuf.Duration`). The name should be in a canonical form
          (e.g., leading "." is not accepted).

          In practice, teams usually precompile into the binary all types that they
          expect it to use in the context of Any. However, for URLs which use the
          scheme `http`, `https`, or no scheme, one can optionally set up a type
          server that maps type URLs to message definitions as follows:

          * If no scheme is provided, `https` is assumed.
          * An HTTP GET on the URL must yield a [google.protobuf.Type][]
            value in binary format, or produce an error.
          * Applications are allowed to cache lookup results based on the
            URL, or have them precompiled into a binary to avoid any
            lookup. Therefore, binary compatibility needs to be preserved
            on changes to types. (Use versioned type names to manage
            breaking changes.)

          Note: this functionality is not currently available in the official
          protobuf release, and it is not used for type URLs beginning with
          type.googleapis.com. As of May 2023, there are no widely used type server
          implementations and no plans to implement one.

          Schemes other than `http`, `https` (or the empty scheme) might be
          used with implementation specific semantics.
    additionalProperties: {}
    description: |-
      `Any` contains an arbitrary serialized protocol buffer message along with a
      URL that describes the type of the serialized message.

      Protobuf library provides support to pack/unpack Any values in the form
      of utility functions or additional generated methods of the Any type.

      Example 1: Pack and unpack a message in C++.

          Foo foo = ...;
          Any any;
          any.PackFrom(foo);
          ...
          if (any.UnpackTo(&foo)) {
            ...
          }

      Example 2: Pack and unpack a message in Java.

          Foo foo = ...;
          Any any = Any.pack(foo);
          ...
          if (any.is(Foo.class)) {
            foo = any.unpack(Foo.class);
          }
          // or ...
          if (any.isSameTypeAs(Foo.getDefaultInstance())) {
            foo = any.unpack(Foo.getDefaultInstance());
          }

       Example 3: Pack and unpack a message in Python.

          foo = Foo(...)
          any = Any()
          any.Pack(foo)
          ...
          if any.Is(Foo.DESCRIPTOR):
            any.Unpack(foo)
            ...

       Example 4: Pack and unpack a message in Go

           foo := &pb.Foo{...}
           any, err := anypb.New(foo)
           if err != nil {
             ...
           }
           ...
           foo := &pb.Foo{}
           if err := any.UnmarshalTo(foo); err != nil {
             ...
           }

      The pack methods provided by protobuf library will by default use
      'type.googleapis.com/full.type.name' as the type URL and the unpack
      methods only use the fully qualified type name after the last '/'
      in the type URL, for example "foo.bar.com/x/y.z" will yield type
      name "y.z".

      JSON
      ====
      The JSON representation of an `Any` value uses the regular
      representation of the deserialized, embedded message, with an
      additional field `@type` which contains the type URL. Example:

          package google.profile;
          message Person {
            string first_name = 1;
            string last_name = 2;
          }

          {
            "@type": "type.googleapis.com/google.profile.Person",
            "firstName": <string>,
            "lastName": <string>
          }

      If the embedded message type is well-known and has a custom JSON
      representation, that representation will be embedded adding a field
      `value` which holds the custom JSON in addition to the `@type`
      field. Example (for message [google.protobuf.Duration][]):

          {
            "@type": "type.googleapis.com/google.protobuf.Duration",
            "value": "1.212s"
          }
  rpcStatus:
    type: object
    properties:
      code:
        type: integer
        format: int32
      message:
        type: string
      details:
        type: array
        items:
          type: object
          $ref: '#/definitions/protobufAny'
  v1AccessToken:
    type: object
    properties:
      id:
        type: string
        description: Unique identifier for the token (UUID).
      tenantId:
        type: string
        description: Tenant this token belongs to (UUID).
      displayName:
        type: string
        description: Human-readable name for the token (e.g., "postman-testing", "ci-deploy-key").
      tokenPrefix:
        type: string
        description: |-
          Display-safe prefix for identifying the token without exposing the secret
          (e.g., "adm_pat_7kH3").
      tokenType:
        $ref: '#/definitions/v1TokenType'
        description: The category of this token.
      scopes:
        type: array
        items:
          type: string
        description: |-
          The scopes granted to this token. For PATs and SATs, these are user-selected.
          For AGTs, these are auto-assigned based on the resource type.
      status:
        $ref: '#/definitions/v1AccessTokenStatus'
        description: Current lifecycle status of the token.
      userId:
        type: string
        description: |-
          The user this token is bound to (UUID). Set when token_type is
          PERSONAL_ACCESS_TOKEN.
      serviceAccountId:
        type: string
        description: |-
          The service account this token is bound to (UUID). Set when token_type is
          SERVICE_ACCOUNT_TOKEN.
      clusterId:
        type: string
        description: |-
          The cluster this token is bound to (UUID). Set when token_type is
          AGENT_TOKEN and the token is bound to a cluster.
      runnerId:
        type: string
        description: |-
          The runner this token is bound to (UUID). Set when token_type is
          AGENT_TOKEN and the token is bound to a runner.
      createdBy:
        type: string
        description: |-
          The user who created this token (UUID). For PATs, this is the token owner.
          For SATs and AGTs, this is the administrator who issued the token.
      expiresAt:
        type: string
        format: date-time
        description: When the token expires. If unset, the token does not expire.
      lastUsedAt:
        type: string
        format: date-time
        description: When the token was last used to authenticate an API request.
      createdAt:
        type: string
        format: date-time
        description: When the token was created.
      revokedAt:
        type: string
        format: date-time
        description: When the token was revoked. Only set when status is REVOKED.
    description: |-
      AccessToken contains token metadata common to all token types (PAT, SAT, AGT).
      The raw token secret is never included in this message — it is only returned
      once at creation time via the `plain_text_token` field in Create responses.

      Token CRUD is managed by each parent resource's API:
        - PATs:         UserAPI            (/v1/user/tokens)
        - SATs:         ServiceAccountAPI  (/v1/service-accounts/{id}/tokens)
        - Cluster AGTs: ClusterAPI         (/v1/clusters/{id}/tokens)
        - Runner AGTs:  RunnerAPI          (/v1/runners/{id}/tokens)
  v1AccessTokenStatus:
    type: string
    enum:
      - ACCESS_TOKEN_STATUS_UNSPECIFIED
      - ACCESS_TOKEN_STATUS_ACTIVE
      - ACCESS_TOKEN_STATUS_REVOKED
      - ACCESS_TOKEN_STATUS_ROTATING
    default: ACCESS_TOKEN_STATUS_UNSPECIFIED
    description: |-
      AccessTokenStatus represents the lifecycle state of an access token.

       - ACCESS_TOKEN_STATUS_UNSPECIFIED: Default value. Must not be used.
       - ACCESS_TOKEN_STATUS_ACTIVE: The token is valid and can be used for authentication.
       - ACCESS_TOKEN_STATUS_REVOKED: The token has been permanently revoked and cannot be used.
       - ACCESS_TOKEN_STATUS_ROTATING: The token is being rotated. Both old and new tokens are valid
      until the grace period expires.
  v1Agent:
    type: object
    properties:
      id:
        type: string
        description: Unique identifier for the agent (UUID).
      tenantId:
        type: string
        description: Tenant this agent belongs to (UUID).
      clusterId:
        type: string
        description: |-
          The cluster this agent is bound to (UUID). Set for Kubernetes agents.
          Mutually exclusive with runner_id.
      runnerId:
        type: string
        description: |-
          The runner this agent is bound to (UUID). Set for runner agents.
          Mutually exclusive with cluster_id.
      displayName:
        type: string
        description: Human-readable name for the agent (e.g., "prod-us-east-1-agent").
      version:
        type: string
        description: Agent software version (e.g., "0.1.0").
      status:
        $ref: '#/definitions/v1AgentStatus'
        description: Current connectivity status.
      lastHeartbeatAt:
        type: string
        format: date-time
        description: When the agent last sent a heartbeat.
      createdAt:
        type: string
        format: date-time
        description: When the agent was registered.
      updatedAt:
        type: string
        format: date-time
        description: When the agent record was last updated.
    description: |-
      Agent represents a registered agent process connected to Admiral's control
      plane. Each agent is bound to exactly one parent resource (Cluster or Runner)
      and tracks the connection state of the deployed agent binary.

      Agent records are system-managed — they are created by RegisterAgent and
      deleted when the parent resource is removed. Admins observe agents via
      GetAgent and ListAgents but do not create, update, or delete them directly.
  v1AgentStatus:
    type: string
    enum:
      - AGENT_STATUS_UNSPECIFIED
      - AGENT_STATUS_ONLINE
      - AGENT_STATUS_OFFLINE
      - AGENT_STATUS_UNREACHABLE
    default: AGENT_STATUS_UNSPECIFIED
    description: |-
      AgentStatus represents the connectivity state of an agent.

       - AGENT_STATUS_UNSPECIFIED: Default value. Must not be used.
       - AGENT_STATUS_ONLINE: The agent is connected and sending heartbeats.
       - AGENT_STATUS_OFFLINE: The agent has gracefully disconnected.
       - AGENT_STATUS_UNREACHABLE: No heartbeat received within 3x the poll interval.
  v1Cluster:
    type: object
    properties:
      id:
        type: string
        description: Unique identifier for the cluster (UUID).
      tenantId:
        type: string
        description: Tenant this cluster belongs to (UUID).
      displayName:
        type: string
        description: Human-readable name (e.g., "prod-us-east-1"). Unique within the tenant.
      labels:
        type: object
        additionalProperties:
          type: string
        description: |-
          Arbitrary key-value labels for organizing and filtering clusters
          (e.g., `{"region": "us-east-1", "cloud": "aws"}`).
      clusterUid:
        type: string
        description: |-
          The Kubernetes kube-system namespace UID, bound at agent registration
          using a first-write-wins strategy. Used to detect when a token is
          accidentally deployed to a different physical cluster.
      healthStatus:
        $ref: '#/definitions/v1ClusterHealthStatus'
        description: Derived health status based on agent connectivity and workload state.
      createdAt:
        type: string
        format: date-time
        description: When the cluster record was created.
      updatedAt:
        type: string
        format: date-time
        description: When the cluster record was last updated.
    description: Cluster represents a registered Kubernetes cluster within a tenant.
  v1ClusterHealthStatus:
    type: string
    enum:
      - CLUSTER_HEALTH_STATUS_UNSPECIFIED
      - CLUSTER_HEALTH_STATUS_PENDING
      - CLUSTER_HEALTH_STATUS_HEALTHY
      - CLUSTER_HEALTH_STATUS_DEGRADED
      - CLUSTER_HEALTH_STATUS_ERROR
      - CLUSTER_HEALTH_STATUS_UNREACHABLE
    default: CLUSTER_HEALTH_STATUS_UNSPECIFIED
    description: |-
      ClusterHealthStatus represents the derived health state of a cluster.
      The status is computed from agent connectivity, node readiness, and workload health.

       - CLUSTER_HEALTH_STATUS_UNSPECIFIED: Default value. Must not be used.
       - CLUSTER_HEALTH_STATUS_PENDING: Cluster record exists but no agent has registered yet.
       - CLUSTER_HEALTH_STATUS_HEALTHY: Agent connected, all nodes ready, less than 10% workloads degraded.
       - CLUSTER_HEALTH_STATUS_DEGRADED: Agent connected, some nodes not ready or workloads in error/degraded state.
       - CLUSTER_HEALTH_STATUS_ERROR: Agent connected, more than 25% nodes not ready or workloads in error state.
       - CLUSTER_HEALTH_STATUS_UNREACHABLE: No heartbeat received within 3x the heartbeat interval.
  v1ClusterStatus:
    type: object
    properties:
      k8sVersion:
        type: string
        description: Kubernetes version reported by the agent (e.g., "1.29.2").
      nodeCount:
        type: integer
        format: int32
        description: Total number of nodes in the cluster.
      nodesReady:
        type: integer
        format: int32
        description: Number of nodes in Ready condition.
      podCapacity:
        type: integer
        format: int32
        description: Maximum number of pods the cluster can schedule.
      podCount:
        type: integer
        format: int32
        description: Total number of pods across all namespaces.
      podsRunning:
        type: integer
        format: int32
        description: Number of pods in Running phase.
      podsPending:
        type: integer
        format: int32
        description: Number of pods in Pending phase.
      podsFailed:
        type: integer
        format: int32
        description: Number of pods in Failed phase.
      cpuCapacityMillicores:
        type: string
        format: int64
        description: Total CPU capacity across all nodes, in millicores.
      cpuUsedMillicores:
        type: string
        format: int64
        description: Current CPU usage across all nodes, in millicores.
      memoryCapacityBytes:
        type: string
        format: int64
        description: Total memory capacity across all nodes, in bytes.
      memoryUsedBytes:
        type: string
        format: int64
        description: Current memory usage across all nodes, in bytes.
      workloadsTotal:
        type: integer
        format: int32
        description: Total number of tracked workloads.
      workloadsHealthy:
        type: integer
        format: int32
        description: Number of workloads in healthy state.
      workloadsDegraded:
        type: integer
        format: int32
        description: Number of workloads in degraded state.
      workloadsError:
        type: integer
        format: int32
        description: Number of workloads in error state.
    description: |-
      ClusterStatus contains the raw telemetry metrics for a cluster, as reported
      by the K8s agent. This message is used in both the push payload
      (ReportClusterStatusRequest) and the read response (GetClusterStatusResponse).

      Server-derived fields (health_status, agent connectivity) are NOT included
      here — they live on the Cluster and Agent records respectively, and are
      returned alongside this message in GetClusterStatusResponse.
  v1ContainerStatus:
    type: object
    properties:
      name:
        type: string
        description: Container name within the pod spec.
      image:
        type: string
        description: Container image reference (e.g., "registry.example.com/api:v2.1.4").
      restartCount:
        type: integer
        format: int32
        description: Cumulative number of container restarts.
      state:
        type: string
        description: Current container state (e.g., "running", "waiting", "terminated").
      ready:
        type: boolean
        description: Whether the container's readiness probe is passing.
    description: ContainerStatus describes the current state of a single container.
  v1CreateClusterRequest:
    type: object
    properties:
      displayName:
        type: string
        description: |-
          Human-readable name for the cluster (e.g., "prod-us-east-1").
          Must be unique within the tenant.
      labels:
        type: object
        additionalProperties:
          type: string
        description: |-
          Arbitrary key-value labels for organizing and filtering clusters
          (e.g., `{"region": "us-east-1", "cloud": "aws"}`).
    description: CreateClusterRequest contains the parameters for creating a new cluster.
  v1CreateClusterResponse:
    type: object
    properties:
      cluster:
        $ref: '#/definitions/v1Cluster'
        description: |-
          The created cluster. Health status will be PENDING until an agent connects
          and calls AgentAPI.RegisterAgent.
      plainTextToken:
        type: string
        description: |-
          The raw Agent Token secret (e.g., "adm_agt_pL2mN5oQ8rS1..."). This value
          is shown exactly once and cannot be retrieved again. Deploy this token to
          the K8s agent for authentication.

          To create additional tokens (e.g., for rotation), use
          AccessTokenAPI.CreateAgentToken.
    description: |-
      CreateClusterResponse contains the newly created cluster and its initial
      Agent Token (AGT).
  v1CreateClusterTokenResponse:
    type: object
    properties:
      accessToken:
        $ref: '#/definitions/v1AccessToken'
        description: The created token metadata. Scopes are auto-assigned for cluster AGTs.
      plainTextToken:
        type: string
        description: |-
          The raw token secret (e.g., "adm_agt_pL2mN5oQ8rS1..."). This value is
          shown exactly once and cannot be retrieved again. Store it securely.
    description: CreateClusterTokenResponse contains the newly created AGT.
  v1CreatePersonalAccessTokenRequest:
    type: object
    properties:
      displayName:
        type: string
        description: |-
          Human-readable name for the token (e.g., "postman-testing").
          Must be unique per user within the tenant.
      scopes:
        type: array
        items:
          type: string
        description: The scopes to grant this token. Must be valid scopes allowed for PATs.
      expiresAt:
        type: string
        format: date-time
        description: |-
          Optional expiration time. If unset, the token does not expire.
          Tenant policies may enforce a maximum lifetime.
    description: CreatePersonalAccessTokenRequest contains the parameters for creating a new PAT.
  v1CreatePersonalAccessTokenResponse:
    type: object
    properties:
      accessToken:
        $ref: '#/definitions/v1AccessToken'
        description: The created token metadata.
      plainTextToken:
        type: string
        description: |-
          The raw token secret (e.g., "adm_pat_7kH3mNqR2xFb..."). This value is
          shown exactly once and cannot be retrieved again. Store it securely.
    description: CreatePersonalAccessTokenResponse contains the newly created PAT.
  v1CreateRunnerRequest:
    type: object
    properties:
      displayName:
        type: string
        description: |-
          Human-readable name for the runner (e.g., "team1-terraform").
          Must be unique within the tenant.
      kind:
        $ref: '#/definitions/v1RunnerKind'
        description: The type of jobs this runner will execute.
      labels:
        type: object
        additionalProperties:
          type: string
        description: Arbitrary key-value labels for organizing and job routing.
    description: CreateRunnerRequest contains the parameters for creating a new runner.
  v1CreateRunnerResponse:
    type: object
    properties:
      runner:
        $ref: '#/definitions/v1Runner'
        description: The created runner.
      plainTextToken:
        type: string
        description: |-
          The raw Agent Token secret (e.g., "adm_agt_pL2mN5oQ8rS1..."). This value
          is shown exactly once and cannot be retrieved again. Deploy this token to
          the controller for authentication.

          To create additional tokens (e.g., for rotation), use
          AccessTokenAPI.CreateAgentToken.
    description: |-
      CreateRunnerResponse contains the newly created runner and its initial
      Agent Token (AGT).
  v1CreateRunnerTokenResponse:
    type: object
    properties:
      accessToken:
        $ref: '#/definitions/v1AccessToken'
        description: The created token metadata. Scopes are auto-assigned for runner AGTs.
      plainTextToken:
        type: string
        description: |-
          The raw token secret (e.g., "adm_agt_pL2mN5oQ8rS1..."). This value is
          shown exactly once and cannot be retrieved again. Store it securely.
    description: CreateRunnerTokenResponse contains the newly created AGT.
  v1CreateServiceAccountRequest:
    type: object
    properties:
      displayName:
        type: string
        description: |-
          Human-readable name for the service account (e.g., "ci-pipeline").
          Must be unique within the tenant.
      description:
        type: string
        description: Optional description of the service account's purpose.
      scopes:
        type: array
        items:
          type: string
        description: |-
          The scopes this service account is allowed to use. SATs created under
          this account can only request a subset of these scopes.
    description: CreateServiceAccountRequest contains the parameters for creating a new service account.
  v1CreateServiceAccountResponse:
    type: object
    properties:
      serviceAccount:
        $ref: '#/definitions/v1ServiceAccount'
        description: The created service account.
    description: CreateServiceAccountResponse contains the newly created service account.
  v1CreateServiceAccountTokenResponse:
    type: object
    properties:
      accessToken:
        $ref: '#/definitions/v1AccessToken'
        description: The created token metadata.
      plainTextToken:
        type: string
        description: |-
          The raw token secret (e.g., "adm_sat_mJ4nP7qR9sT2..."). This value is
          shown exactly once and cannot be retrieved again. Store it securely.
    description: CreateServiceAccountTokenResponse contains the newly created SAT.
  v1DeleteClusterResponse:
    type: object
    description: DeleteClusterResponse is empty on success.
  v1DeleteRunnerResponse:
    type: object
    description: DeleteRunnerResponse is empty on success.
  v1DeleteServiceAccountResponse:
    type: object
    description: DeleteServiceAccountResponse is empty on success.
  v1GetAgentResponse:
    type: object
    properties:
      agent:
        $ref: '#/definitions/v1Agent'
        description: The agent.
    description: GetAgentResponse contains the requested agent.
  v1GetClusterResponse:
    type: object
    properties:
      cluster:
        $ref: '#/definitions/v1Cluster'
        description: The cluster record, including server-derived health_status.
    description: GetClusterResponse contains the cluster record.
  v1GetClusterStatusResponse:
    type: object
    properties:
      healthStatus:
        $ref: '#/definitions/v1ClusterHealthStatus'
        description: |-
          Server-derived health status based on agent connectivity, node readiness,
          and workload health.
      status:
        $ref: '#/definitions/v1ClusterStatus'
        description: |-
          Latest telemetry snapshot from the agent. Absent if no telemetry has
          been reported yet.
      reportedAt:
        type: string
        format: date-time
        description: When the latest telemetry was reported by the agent.
    description: |-
      GetClusterStatusResponse contains the server-derived health status and the
      latest telemetry snapshot. If no agent has reported telemetry yet, the
      health_status will be PENDING and status will be absent.
  v1GetClusterTokenResponse:
    type: object
    properties:
      accessToken:
        $ref: '#/definitions/v1AccessToken'
        description: The token metadata. The token secret is never included.
    description: GetClusterTokenResponse contains the requested cluster AGT metadata.
  v1GetPersonalAccessTokenResponse:
    type: object
    properties:
      accessToken:
        $ref: '#/definitions/v1AccessToken'
        description: The token metadata. The token secret is never included.
    description: GetPersonalAccessTokenResponse contains the requested PAT metadata.
  v1GetRunnerResponse:
    type: object
    properties:
      runner:
        $ref: '#/definitions/v1Runner'
        description: The runner.
    description: GetRunnerResponse contains the requested runner.
  v1GetRunnerTokenResponse:
    type: object
    properties:
      accessToken:
        $ref: '#/definitions/v1AccessToken'
        description: The token metadata. The token secret is never included.
    description: GetRunnerTokenResponse contains the requested runner AGT metadata.
  v1GetServiceAccountResponse:
    type: object
    properties:
      serviceAccount:
        $ref: '#/definitions/v1ServiceAccount'
        description: The service account.
    description: GetServiceAccountResponse contains the requested service account.
  v1GetServiceAccountTokenResponse:
    type: object
    properties:
      accessToken:
        $ref: '#/definitions/v1AccessToken'
        description: The token metadata. The token secret is never included.
    description: GetServiceAccountTokenResponse contains the requested SAT metadata.
  v1GetUserResponse:
    type: object
    properties:
      id:
        type: string
        description: Unique identifier for the user (UUID format).
      tenantId:
        type: string
        description: The tenant this user belongs to (UUID format).
      email:
        type: string
        description: User's email address.
      displayName:
        type: string
        description: User's display name for UI purposes.
      givenName:
        type: string
        description: User's given (first) name.
      familyName:
        type: string
        description: User's family (last) name.
      avatarUrl:
        type: string
        description: URL to the user's avatar image.
    description: GetUserResponse contains the authenticated user's profile information.
  v1HealthcheckResponse:
    type: object
    description: |-
      HealthcheckResponse is returned when the service is healthy.
      An empty response indicates the service is operating normally.
  v1HeartbeatResponse:
    type: object
    properties:
      ok:
        type: boolean
        description: Whether the heartbeat was accepted.
      pollIntervalSeconds:
        type: integer
        format: int32
        description: |-
          Server-controlled heartbeat interval in seconds. The agent should use
          this value for its next heartbeat cycle. Allows the server to dynamically
          adjust frequency (e.g., faster when changes are pending).
      statusPushIntervalSeconds:
        type: integer
        format: int32
        description: Server-controlled status push interval in seconds.
    description: |-
      HeartbeatResponse acknowledges the heartbeat and provides server-controlled
      configuration for the agent's polling behavior.
  v1KubernetesAgentMetadata:
    type: object
    properties:
      clusterUid:
        type: string
        description: |-
          The UID of the kube-system namespace, used as a stable physical cluster
          identifier. Written to the Cluster record on first registration using a
          first-write-wins strategy. If a subsequent registration presents a
          different UID, the server returns 409 Conflict.
    description: |-
      KubernetesAgentMetadata contains registration-time metadata for a Kubernetes
      cluster agent. This is sent once during RegisterAgent, not on every heartbeat.
      Dynamic telemetry (k8s version, node count, etc.) is reported separately via
      ClusterAPI.ReportClusterStatus.
  v1ListAgentsResponse:
    type: object
    properties:
      agents:
        type: array
        items:
          type: object
          $ref: '#/definitions/v1Agent'
        description: The list of agents.
      nextPageToken:
        type: string
        description: Pagination token for the next page. Empty when there are no more results.
    description: ListAgentsResponse contains a page of agents.
  v1ListClusterTokensResponse:
    type: object
    properties:
      accessTokens:
        type: array
        items:
          type: object
          $ref: '#/definitions/v1AccessToken'
        description: The list of tokens. Token secrets are never included.
      nextPageToken:
        type: string
        description: Pagination token for the next page. Empty when there are no more results.
    description: ListClusterTokensResponse contains a page of cluster AGT metadata.
  v1ListClustersResponse:
    type: object
    properties:
      clusters:
        type: array
        items:
          type: object
          $ref: '#/definitions/v1Cluster'
        description: The list of clusters.
      nextPageToken:
        type: string
        description: Pagination token for the next page. Empty when there are no more results.
    description: ListClustersResponse contains a page of clusters.
  v1ListPersonalAccessTokensResponse:
    type: object
    properties:
      accessTokens:
        type: array
        items:
          type: object
          $ref: '#/definitions/v1AccessToken'
        description: The list of tokens. Token secrets are never included.
      nextPageToken:
        type: string
        description: Pagination token for the next page. Empty when there are no more results.
    description: ListPersonalAccessTokensResponse contains a page of PAT metadata.
  v1ListRunnerTokensResponse:
    type: object
    properties:
      accessTokens:
        type: array
        items:
          type: object
          $ref: '#/definitions/v1AccessToken'
        description: The list of tokens. Token secrets are never included.
      nextPageToken:
        type: string
        description: Pagination token for the next page. Empty when there are no more results.
    description: ListRunnerTokensResponse contains a page of runner AGT metadata.
  v1ListRunnersResponse:
    type: object
    properties:
      runners:
        type: array
        items:
          type: object
          $ref: '#/definitions/v1Runner'
        description: The list of runners.
      nextPageToken:
        type: string
        description: Pagination token for the next page. Empty when there are no more results.
    description: ListRunnersResponse contains a page of runners.
  v1ListServiceAccountTokensResponse:
    type: object
    properties:
      accessTokens:
        type: array
        items:
          type: object
          $ref: '#/definitions/v1AccessToken'
        description: The list of tokens. Token secrets are never included.
      nextPageToken:
        type: string
        description: Pagination token for the next page. Empty when there are no more results.
    description: ListServiceAccountTokensResponse contains a page of SAT metadata.
  v1ListServiceAccountsResponse:
    type: object
    properties:
      serviceAccounts:
        type: array
        items:
          type: object
          $ref: '#/definitions/v1ServiceAccount'
        description: The list of service accounts.
      nextPageToken:
        type: string
        description: Pagination token for the next page. Empty when there are no more results.
    description: ListServiceAccountsResponse contains a page of service accounts.
  v1ListWorkloadsResponse:
    type: object
    properties:
      workloads:
        type: array
        items:
          type: object
          $ref: '#/definitions/v1Workload'
        description: The list of workloads.
      nextPageToken:
        type: string
        description: Pagination token for the next page. Empty when there are no more results.
    description: ListWorkloadsResponse contains a page of workloads.
  v1ObjectReference:
    type: object
    properties:
      kind:
        type: string
        description: Kubernetes resource kind (e.g., "Pod", "ReplicaSet").
      namespace:
        type: string
        description: Kubernetes namespace.
      name:
        type: string
        description: Object name.
    description: ObjectReference is a lightweight reference to a Kubernetes object.
  v1RegisterAgentRequest:
    type: object
    properties:
      displayName:
        type: string
        description: Human-readable name for the agent.
      version:
        type: string
        description: Agent software version (e.g., "0.1.0").
      kubernetes:
        $ref: '#/definitions/v1KubernetesAgentMetadata'
        description: |-
          Registration metadata for Kubernetes cluster agents. Required when the
          AGT is bound to a Cluster.
      runner:
        $ref: '#/definitions/v1RunnerAgentMetadata'
        description: |-
          Registration metadata for runner agents. Required when the AGT is
          bound to a Runner.
    description: |-
      RegisterAgentRequest contains the parameters for registering a new agent.
      The parent resource binding (Cluster or Runner) is derived from the AGT
      used to authenticate — it does not need to be specified in the request.
  v1RegisterAgentResponse:
    type: object
    properties:
      agent:
        $ref: '#/definitions/v1Agent'
        description: |-
          The registered agent. On first registration, a new record is created with
          status ONLINE. On re-registration (agent restart), the existing record is
          returned with status set to ONLINE.
      pollIntervalSeconds:
        type: integer
        format: int32
        description: |-
          Server-controlled heartbeat interval in seconds. The agent should send
          heartbeats at this frequency. If no heartbeat is received within 3x this
          interval, the agent transitions to UNREACHABLE.
      statusPushIntervalSeconds:
        type: integer
        format: int32
        description: |-
          Server-controlled status push interval in seconds. For Kubernetes agents,
          this controls how often to push cluster telemetry via ReportClusterStatus.
    description: |-
      RegisterAgentResponse contains the registered agent and server-controlled
      configuration for the agent's polling behavior.
  v1ReportClusterStatusResponse:
    type: object
    properties:
      ack:
        type: boolean
        description: Whether the report was accepted.
      nextPushSeconds:
        type: integer
        format: int32
        description: |-
          Server-controlled interval (in seconds) before the agent should send
          its next status push. Allows the server to adjust push frequency dynamically.
    description: ReportClusterStatusResponse acknowledges a telemetry push.
  v1ReportWorkloadStatusResponse:
    type: object
    properties:
      ack:
        type: boolean
        description: Whether the report was accepted.
    description: ReportWorkloadStatusResponse acknowledges a workload telemetry push.
  v1RevokeClusterTokenResponse:
    type: object
    properties:
      accessToken:
        $ref: '#/definitions/v1AccessToken'
        description: The token metadata with updated status.
    description: RevokeClusterTokenResponse contains the revoked cluster AGT metadata.
  v1RevokePersonalAccessTokenResponse:
    type: object
    properties:
      accessToken:
        $ref: '#/definitions/v1AccessToken'
        description: The token metadata with updated status.
    description: RevokePersonalAccessTokenResponse contains the revoked PAT metadata.
  v1RevokeRunnerTokenResponse:
    type: object
    properties:
      accessToken:
        $ref: '#/definitions/v1AccessToken'
        description: The token metadata with updated status.
    description: RevokeRunnerTokenResponse contains the revoked runner AGT metadata.
  v1RevokeServiceAccountTokenResponse:
    type: object
    properties:
      accessToken:
        $ref: '#/definitions/v1AccessToken'
        description: The token metadata with updated status.
    description: RevokeServiceAccountTokenResponse contains the revoked SAT metadata.
  v1Runner:
    type: object
    properties:
      id:
        type: string
        description: Unique identifier for the runner (UUID).
      tenantId:
        type: string
        description: Tenant this runner belongs to (UUID).
      displayName:
        type: string
        description: Human-readable name (e.g., "team1-terraform"). Unique within the tenant.
      kind:
        $ref: '#/definitions/v1RunnerKind'
        description: The type of jobs this runner can execute.
      labels:
        type: object
        additionalProperties:
          type: string
        description: |-
          Arbitrary key-value labels for organizing, filtering, and job routing.
          Labels are set by admins and used in the UI to select which runner should
          execute a given module or workflow (e.g., `{"team": "platform", "env": "prod"}`).
      createdAt:
        type: string
        format: date-time
        description: When the runner was created.
      updatedAt:
        type: string
        format: date-time
        description: When the runner was last updated.
    description: |-
      Runner represents an execution environment for IaC or workflow jobs within a
      tenant. Each runner is backed by a controller process that holds an AGT,
      registers as an agent, and spawns ephemeral pods to execute work.

      Runners serve as credential boundaries — different teams or cloud accounts
      should use separate runners to maintain isolation (e.g., via Workload Identity
      in GKE where each controller runs under a distinct K8s ServiceAccount).
  v1RunnerAgentMetadata:
    type: object
    description: |-
      RunnerAgentMetadata contains registration-time metadata for a runner agent.
      Currently empty — runner configuration is managed on the Runner resource by
      admins, not self-reported by the agent at registration.
  v1RunnerKind:
    type: string
    enum:
      - RUNNER_KIND_UNSPECIFIED
      - RUNNER_KIND_TERRAFORM
      - RUNNER_KIND_WORKFLOW
    default: RUNNER_KIND_UNSPECIFIED
    description: |-
      RunnerKind identifies the type of jobs a runner can execute.

       - RUNNER_KIND_UNSPECIFIED: Default value. Must not be used.
       - RUNNER_KIND_TERRAFORM: Terraform / OpenTofu runner. Executes plan and apply operations.
       - RUNNER_KIND_WORKFLOW: Workflow runner. Executes custom workflow steps.
  v1ServiceAccount:
    type: object
    properties:
      id:
        type: string
        description: Unique identifier for the service account (UUID).
      tenantId:
        type: string
        description: Tenant this service account belongs to (UUID).
      displayName:
        type: string
        description: Human-readable name, unique within the tenant (e.g., "ci-pipeline").
      description:
        type: string
        description: |-
          Optional description of the service account's purpose
          (e.g., "GitHub Actions deployment automation").
      scopes:
        type: array
        items:
          type: string
        description: |-
          The set of scopes this service account is allowed to use.
          SATs created under this account can only request a subset of these scopes.
      status:
        $ref: '#/definitions/v1ServiceAccountStatus'
        description: Current lifecycle status.
      createdBy:
        type: string
        description: |-
          The user who created this service account (UUID). For audit purposes only —
          the service account is not bound to this user's access.
      createdAt:
        type: string
        format: date-time
        description: When the service account was created.
      updatedAt:
        type: string
        format: date-time
        description: When the service account was last updated.
    description: |-
      ServiceAccount is a first-class non-human identity within a tenant.
      It represents a machine identity (e.g., CI/CD pipeline, external integration)
      and can have multiple SATs (credentials) attached for key rotation.
  v1ServiceAccountStatus:
    type: string
    enum:
      - SERVICE_ACCOUNT_STATUS_UNSPECIFIED
      - SERVICE_ACCOUNT_STATUS_ACTIVE
      - SERVICE_ACCOUNT_STATUS_DISABLED
    default: SERVICE_ACCOUNT_STATUS_UNSPECIFIED
    description: |-
      ServiceAccountStatus represents the lifecycle state of a service account.

       - SERVICE_ACCOUNT_STATUS_UNSPECIFIED: Default value. Must not be used.
       - SERVICE_ACCOUNT_STATUS_ACTIVE: The service account is active and its SATs can be used for authentication.
       - SERVICE_ACCOUNT_STATUS_DISABLED: The service account is disabled. All associated SATs are invalidated
      and cannot be used until the account is re-enabled.
  v1TokenType:
    type: string
    enum:
      - TOKEN_TYPE_UNSPECIFIED
      - PERSONAL_ACCESS_TOKEN
      - SERVICE_ACCOUNT_TOKEN
      - AGENT_TOKEN
    default: TOKEN_TYPE_UNSPECIFIED
    description: |-
      TokenType identifies the category of an access token issued by Admiral's token system.
      IDP-issued JWTs (OAuth2/OIDC sessions) are NOT represented here — they are
      resolved by separate middleware and can be referenced as "session" in
      AuthRule.allowed_token_types when needed.
  v1UpdateClusterResponse:
    type: object
    properties:
      cluster:
        $ref: '#/definitions/v1Cluster'
        description: The updated cluster.
    description: UpdateClusterResponse contains the updated cluster.
  v1UpdateRunnerResponse:
    type: object
    properties:
      runner:
        $ref: '#/definitions/v1Runner'
        description: The updated runner.
    description: UpdateRunnerResponse contains the updated runner.
  v1UpdateServiceAccountResponse:
    type: object
    properties:
      serviceAccount:
        $ref: '#/definitions/v1ServiceAccount'
        description: The updated service account.
    description: UpdateServiceAccountResponse contains the updated service account.
  v1Workload:
    type: object
    properties:
      id:
        type: string
        description: Unique identifier for the workload within Admiral (UUID).
      clusterId:
        type: string
        description: The cluster this workload belongs to (UUID).
      namespace:
        type: string
        description: Kubernetes namespace.
      name:
        type: string
        description: Workload name.
      kind:
        type: string
        description: Kubernetes resource kind (e.g., "Deployment", "StatefulSet", "DaemonSet").
      labels:
        type: object
        additionalProperties:
          type: string
        description: Kubernetes labels on the workload.
      healthStatus:
        $ref: '#/definitions/v1WorkloadHealthStatus'
        description: Derived health status.
      statusReason:
        type: string
        description: Human-readable reason for the current status (e.g., "MinimumReplicasUnavailable").
      replicasDesired:
        type: integer
        format: int32
        description: Number of desired replicas.
      replicasReady:
        type: integer
        format: int32
        description: Number of ready replicas.
      replicasAvailable:
        type: integer
        format: int32
        description: Number of available replicas.
      cpuRequestsMillicores:
        type: string
        format: int64
        description: CPU requests across all containers, in millicores.
      cpuLimitsMillicores:
        type: string
        format: int64
        description: CPU limits across all containers, in millicores.
      cpuUsedMillicores:
        type: string
        format: int64
        description: Current CPU usage across all containers, in millicores.
      memoryRequestsBytes:
        type: string
        format: int64
        description: Memory requests across all containers, in bytes.
      memoryLimitsBytes:
        type: string
        format: int64
        description: Memory limits across all containers, in bytes.
      memoryUsedBytes:
        type: string
        format: int64
        description: Current memory usage across all containers, in bytes.
      containers:
        type: array
        items:
          type: object
          $ref: '#/definitions/v1ContainerStatus'
        description: Status of individual containers in this workload.
      lastUpdatedAt:
        type: string
        format: date-time
        description: When this workload's status was last updated.
    description: |-
      Workload represents a Kubernetes workload (Deployment, StatefulSet,
      DaemonSet, etc.) as observed by the agent.
  v1WorkloadEvent:
    type: object
    properties:
      uid:
        type: string
        description: Kubernetes event UID, used for deduplication.
      type:
        type: string
        description: 'Event type: "Normal" or "Warning".'
      reason:
        type: string
        description: Short machine-readable reason (e.g., "BackOff", "FailedScheduling").
      regarding:
        $ref: '#/definitions/v1ObjectReference'
        description: The Kubernetes object this event is about.
      message:
        type: string
        description: Human-readable event message.
      firstSeen:
        type: string
        format: date-time
        description: When this event was first observed.
      lastSeen:
        type: string
        format: date-time
        description: When this event was most recently observed.
      count:
        type: integer
        format: int32
        description: Number of times this event has occurred.
    description: |-
      WorkloadEvent represents a Kubernetes event related to a workload or its
      child objects (pods, replicasets). Events are deduplicated by their K8s UID.
  v1WorkloadHealthStatus:
    type: string
    enum:
      - WORKLOAD_HEALTH_STATUS_UNSPECIFIED
      - WORKLOAD_HEALTH_STATUS_HEALTHY
      - WORKLOAD_HEALTH_STATUS_DEGRADED
      - WORKLOAD_HEALTH_STATUS_ERROR
    default: WORKLOAD_HEALTH_STATUS_UNSPECIFIED
    description: |-
      WorkloadHealthStatus represents the derived health state of a single workload.

       - WORKLOAD_HEALTH_STATUS_UNSPECIFIED: Default value. Must not be used.
       - WORKLOAD_HEALTH_STATUS_HEALTHY: All desired replicas ready, no CrashLoopBackOff, restarts stable.
       - WORKLOAD_HEALTH_STATUS_DEGRADED: Some replicas not ready, restarts increasing, or pods pending over 5 minutes.
       - WORKLOAD_HEALTH_STATUS_ERROR: Zero ready replicas, all containers CrashLoopBackOff, or deployment stuck.
  v1WorkloadStatus:
    type: object
    properties:
      namespace:
        type: string
        description: Kubernetes namespace.
      name:
        type: string
        description: Workload name.
      kind:
        type: string
        description: Kubernetes resource kind (e.g., "Deployment", "StatefulSet").
      labels:
        type: object
        additionalProperties:
          type: string
        description: Kubernetes labels on the workload.
      replicasDesired:
        type: integer
        format: int32
        description: Number of desired replicas.
      replicasReady:
        type: integer
        format: int32
        description: Number of ready replicas.
      replicasAvailable:
        type: integer
        format: int32
        description: Number of available replicas.
      cpuRequestsMillicores:
        type: string
        format: int64
        description: CPU requests across all containers, in millicores.
      cpuLimitsMillicores:
        type: string
        format: int64
        description: CPU limits across all containers, in millicores.
      cpuUsedMillicores:
        type: string
        format: int64
        description: Current CPU usage across all containers, in millicores.
      memoryRequestsBytes:
        type: string
        format: int64
        description: Memory requests across all containers, in bytes.
      memoryLimitsBytes:
        type: string
        format: int64
        description: Memory limits across all containers, in bytes.
      memoryUsedBytes:
        type: string
        format: int64
        description: Current memory usage across all containers, in bytes.
      healthStatus:
        $ref: '#/definitions/v1WorkloadHealthStatus'
        description: Derived health status.
      containers:
        type: array
        items:
          type: object
          $ref: '#/definitions/v1ContainerStatus'
        description: Status of individual containers.
    description: |-
      WorkloadStatus is the agent-reported status for a single workload within
      a telemetry push payload.
